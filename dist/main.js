!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function a(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function r(e){return"number"==typeof e?e:e.reduce((e,t)=>e+t)}n.r(t);const l=document.getElementById("last-played-top");let s=document.createElement("div");function i(e,t,n){return null!=t[0].Name&&e[0].push(n),null!=t[1].Name&&e[1].push(n),e}function o(e,t,n){return null!=t[0].Name&&"Hero"==t[0].CardType&&e[0].push(n),null!=t[1].Name&&"Hero"==t[0].CardType&&e[1].push(n),e}function c(e,t,n){return null!=t[0].Name&&"Creep"==t[0].CardType&&e[0].push(n),null!=t[1].Name&&"Creep"==t[1].CardType&&e[1].push(n),e}l.appendChild(s);let d=["Intimidation","Bellow","Relentless Pursuit","Viscous Nasal Goo","Crippling Blow","Rend Armor","Grazing Shot","No Accident","Slay","Pick Off","Assassinate"];d=new Map(d.map(e=>[e,!0]));let u=["Slay","Bellow"];u=new Map(u.map(e=>[e,!0]));const f={actionPhase:e=>{let t;a(e.hand);e:for(var n=0;n<e.hand.length;n++)if(((t=e.hand[n]).ManaCost||0)<=v.lanes[F.getCurrentLane()].towers[e.turn].mana[0]&&(t.div.ondragstart(new DragEvent({setData:null})),v.lanes[F.getCurrentLane()].cards.some(T))){if("Creep"==y.CardType){let t=v.lanes[F.getCurrentLane()].cards.reduce(z,[[],[]])[e.turn],n={preventDefault:()=>{},target:(t=v.lanes[F.getCurrentLane()].cards[t[Math.floor(Math.random()*t.length)]][e.turn]).div,currentTarget:t.div};t.drop(n);break e}if("Improvement"==y.CardType){let e=v.lanes[Math.floor(3*Math.random())],t={preventDefault:()=>{},target:e.div,currentTarget:e.div};e.drop(t);break e}if("Spell"==y.CardType){let n,a=m.get(y.Name);if(n=y.CrossLane?v.lanes[Math.floor(3*Math.random())]:v.lanes[F.getCurrentLane()],"lane"==a)a=n;else if("unit"==a){let r=d.get(t.Name)?1-e.turn:e.turn;if((a=u.get(t.Name)?n.cards.reduce(c,[[],[]])[r]:n.cards.reduce(o,[[],[]])[r]).length<=0)break e;a=n.cards[a[Math.floor(Math.random()*a.length)]][r]}let r={preventDefault:()=>{},target:a.div,currentTarget:a.div};a.drop(r);break e}break e}F.getTurn()!=e.turn&&(t=t.div.cloneNode(!0),s.parentNode.replaceChild(t,s),s=t),setTimeout(function(){F.getTurn()==e.turn&&F.pass()},300)}};let p=new Map,m=new Map;function h(e,t,n,a=(()=>!0)){e.div.classList.add("glow"),F.div.classList.add("target"),F.div.addEventListener("click",function r(l){l.stopPropagation();let s=l.path||l.composedPath&&l.composedPath();s||console.log("no path");e:{if(e!=y)break e;let r,l=s.find(function(e){if(e.classList)return e.classList.contains("lane")});if(void 0!=l){if(l=v.lanes.find(function(e){return e.div==l}),"card"==t||"empty"==t){if(void 0==(r=s.find(function(e){if(e.classList)return e.classList.contains("playarea")})))break e;r=l.playAreas.findIndex(function(e){return e==r})}else if("tower"==t){if(void 0==(r=s.find(function(e){if(e.classList)return e.classList.contains("tower")})))break e;r=l.towers.findIndex(function(e){return e.div==r})}if("card"==t){if(void 0==(t=s.find(function(e){if(e.classList)return e.classList.contains("card")})))break e;t=l.cards.findIndex(function(e){return e[r].div==t})}else if("empty"==t){if(void 0==(t=s.find(function(e){if(e.classList)return e.classList.contains("blank")})))break e;t=l.cards.findIndex(function(e){return e[r].div==t})}else"tower"==t&&(t=r);a(l,r,t)&&(n(l,r,t),v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]-=e.ManaCost,v.lanes[F.getCurrentLane()].towers[F.getTurn()].updateDisplay(),F.players[F.getTurn()].hand.splice(F.players[F.getTurn()].hand.indexOf(y),1),y.div.parentNode.removeChild(y.div),F.nextTurn())}}e.div.classList.remove("glow"),F.div.classList.remove("target"),F.div.removeEventListener("click",r,!0)},!0)}m.set("Dimensional Portal","lane"),p.set("Dimensional Portal",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<3;e++){let e=D(G.Cards[132],F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Better Late Than Never","lane"),p.set("Better Late Than Never",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<1;e++){let e=D(G.Cards[132],F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Call the Reserves","lane"),p.set("Call the Reserves",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<2;e++){let e=D(G.Cards[132],F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Iron Branch Protection","unit"),p.set("Iron Branch Protection",function(e,t,n,a){return v.lanes[t].cards[a][n].currentArmor[5]+=3,v.lanes[t].cards[a][n].updateDisplay(),!0}),m.set("Avernus' Blessing","unit"),p.set("Avernus' Blessing",function(e,t,n,a){return v.lanes[t].cards[a][n].currentAttack[1+(1-n==F.getTurn())]+=2,v.lanes[t].cards[a][n].updateDisplay(),!0}),m.set("Double Edge","unit"),p.set("Double Edge",function(e,t,n,a){return"Red"==v.lanes[t].cards[a][n].Color&&"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentArmor[3]-=8,v.lanes[t].cards[a][n].currentAttack[3]+=8,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Poised to Strike","unit"),p.set("Poised to Strike",function(e,t,n,a){return"Red"==v.lanes[t].cards[a][n].Color&&"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentAttack[3]+=4,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Defensive Stance","unit"),p.set("Defensive Stance",function(e,t,n,a){return"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentArmor[5]+=3,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Combat Training","unit"),p.set("Combat Training",function(e,t,n,a){return"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentAttack[1+(1-n==F.getTurn())]+=2,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Enrage","unit"),p.set("Enrage",function(e,t,n,a){return"Red"==v.lanes[t].cards[a][n].Color&&"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentArmor[3]+=4,v.lanes[t].cards[a][n].currentAttack[3]+=4,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("God's Strength","unit"),p.set("God's Strength",function(e,t,n,a){return"Red"==v.lanes[t].cards[a][n].Color&&"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentAttack[1+(1-n==F.getTurn())]+=4,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Spring the Trap","lane"),p.set("Spring the Trap",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<2;e++){let e=D(G.Cards.find(function(e){return"Centaur Hunter"==e.Name}),F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Strafing Run","lane"),p.set("Strafing Run",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[1-a].Name&&"Creep"==e[1-a].CardType&&(e[1-a].currentHealth[0]-=2-r(e[1-a].currentArmor))}),n.collapse(),!0}),m.set("Lightning Strike","lane"),p.set("Lightning Strike",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[1-a].currentHealth[0]-=6-r(n.towers[1-a].currentArmor),n.towers[1-a].updateDisplay(),!0}),m.set("Rolling Storm","lane"),p.set("Rolling Storm",function(e,t){let n=F.getTurn();return v.lanes.forEach(function(e){e.towers[n].currentHealth[0]-=2-r(e.towers[n].currentArmor),e.towers[n].updateDisplay(),e.towers[1-n].currentHealth[0]-=2-r(e.towers[1-n].currentArmor),e.towers[1-n].updateDisplay()}),!0}),m.set("Tower Barrage","lane"),p.set("Tower Barrage",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[1-a].Name&&(e[1-a].currentHealth[0]-=2-r(e[1-a].currentArmor))}),n.collapse(),!0}),m.set("Foresight","lane"),p.set("Foresight",function(e,t){let n=F.players[F.getTurn()];return n.draw(),n.draw(),!0}),m.set("Prey on the Weak","lane"),p.set("Prey on the Weak",function(e,t){let n=v.lanes[t],a=[[],[]],r=F.getTurn();return n.cards.forEach(function(e){if(null!=e[1-r].Name&&e[1-r].currentHealth[0]<e[1-r].Health){let e=D(G.Cards.find(function(e){return"Hound of War"==e.Name}),F.players[F.getTurn()]);a[F.getTurn()].push(e)}if(null!=e[r].Name&&e[r].currentHealth[0]<e[r].Health){let e=D(G.Cards.find(function(e){return"Hound of War"==e.Name}),F.players[F.getTurn()]);a[F.getTurn()].push(e)}}),n.summon(a),!0}),m.set("Remote Detonation","lane"),p.set("Remote Detonation",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[1-a].Name&&null==e[a].Name&&(e[1-a].currentHealth[0]-=5-r(e[1-a].currentArmor))}),n.collapse(),!0}),m.set("Thunderstorm","lane"),p.set("Thunderstorm",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[1-a].Name&&(e[1-a].currentHealth[0]-=4-r(e[1-a].currentArmor))}),n.collapse(),!0}),m.set("Bolt of Damocles","lane"),p.set("Bolt of Damocles",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[1-a].currentHealth[0]-=20-r(n.towers[1-a].currentArmor),n.towers[1-a].updateDisplay(),!0}),m.set("Stars Align","lane"),p.set("Stars Align",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[a].mana[0]+=3,n.towers[a].updateDisplay(),!0}),m.set("Bellow","unit"),p.set("Bellow",function(e,t,n,a){let r=[[],[]];if("Creep"!=v.lanes[t].cards[a][n].CardType)return!1;let l=v.lanes[t].cards[a][n],s=w(t);return v.lanes[t].cards[a][n]=s,l.div.parentNode.replaceChild(s.div,l.div),r[n].push(l),v.lanes[(t+Math.ceil(2*Math.random()))%3].summon(r),!0}),m.set("Rumusque Blessing","lane"),p.set("Rumusque Blessing",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[a].Name&&(e[a].currentHealth[1]+=3,e[a].updateDisplay())}),!0}),m.set("Defensive Bloom","lane"),p.set("Defensive Bloom",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<2;e++){let e=D(G.Cards.find(function(e){return"Roseleaf Wall"==e.Name}),F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Restoration Effort","lane"),p.set("Restoration Effort",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[a].currentHealth[0]+=8,n.towers[a].updateDisplay(),!0}),m.set("Intimidation","unit"),p.set("Intimidation",function(e,t,n,a){let r=[[],[]],l=v.lanes[t].cards[a][n],s=w(t);return v.lanes[t].cards[a][n]=s,l.div.parentNode.replaceChild(s.div,l.div),r[n].push(l),v.lanes[(t+Math.ceil(2*Math.random()))%3].summon(r),!0}),m.set("Curse of Atrophy","lane"),p.set("Curse of Atrophy",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[1-a].Name&&"Hero"==e[1-a].CardType&&(e[1-a].currentAttack[2]-=2,e[1-a].updateDisplay())}),!0}),m.set("Grazing Shot","unit"),p.set("Grazing Shot",function(e,t,n,a){let l=v.lanes[t];return l.cards[a][n].currentHealth[0]-=2-r(l.cards[a][n].currentArmor),l.collapse(),!0}),m.set("Mana Drain","lane"),p.set("Mana Drain",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[a].mana[0]+=2,n.towers[a].updateDisplay(),n.towers[1-a].mana[0]-=2,n.towers[1-a].updateDisplay(),!0}),m.set("No Accident","unit"),p.set("No Accident",function(e,t,n,a){let l=v.lanes[t];return l.cards[a][n].currentHealth[0]-=3-r(l.cards[a][n].currentArmor),l.collapse(),!0}),m.set("Payday","lane"),p.set("Payday",function(e,t){return F.players[F.getTurn()].gold*=2,F.infoDisplayUpdate(),!0}),m.set("Slay","unit"),p.set("Slay",function(e,t,n,a){let r=v.lanes[t];return"Creep"==r.cards[a][n].CardType&&(F.condemn(r.cards[a][n],v.lanes[t]),F.infoDisplayUpdate(),r.collapse(),!0)}),m.set("Arcane Censure","lane"),p.set("Arcane Censure",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.towers[1-a].mana[1]-=1,n.towers[1-a].mana[0]-=1,n.towers[1-a].updateDisplay(),!0}),m.set("Pick Off","unit"),p.set("Pick Off",function(e,t,n,a){let l=v.lanes[t];return l.cards[a][n].currentHealth[0]-=4-r(l.cards[a][n].currentArmor),l.collapse(),!0}),m.set("Assassinate","unit"),p.set("Assassinate",function(e,t,n,a){let l=v.lanes[t];return l.cards[a][n].currentHealth[0]-=10-(r(l.cards[a][n].currentArmor)<0?r(l.cards[a][n].currentArmor):0),l.collapse(),!0}),m.set("New Orders","unit"),p.set("New Orders",function(e,t,n,a){let r=v.lanes[t],l=r.cards[a][n];return h(y,"card",function(e,t,n){l.arrow=n-a,l.updateDisplay()},function(e,t,l){return e==r&&F.players[n]!=t&&Math.abs(l-a)<=1}),!1}),m.set("Steal Strength","unit"),p.set("Steal Strength",function(e,t,n,a){let r=v.lanes[t],l=r.cards[a][n];return h(y,"card",function(e,t,n){l.currentAttack[3]-=4,l.updateDisplay();let a=e.cards[n][t];a.currentAttack[3]+=4,a.updateDisplay()},function(e,t,n){return e==r}),!1}),m.set("Ion Shell","unit"),p.set("Ion Shell",function(e,t,n,a){return v.lanes[t].cards[a][n].retaliate[1+(1-n==F.getTurn())]+=3,v.lanes[t].cards[a][n].updateDisplay(),!0}),m.set("Forward Charge","lane"),p.set("Forward Charge",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[a].Name&&(e[a].siege[3]+=2,e.arrow=0,e[a].updateDisplay())}),!0}),m.set("Time of Triumph","lane"),p.set("Time of Triumph",function(e,t){let n=v.lanes[t],a=F.getTurn();return n.cards.forEach(function(e){null!=e[a].Name&&"Hero"==e[a].CardType&&(e[a].currentAttack[1]+=4,e[a].currentArmor[1]+=4,e[a].currentHealth[1]+=4,e[a].cleave[1]+=4,e[a].retaliate[1]+=4,e[a].siege[1]+=4,e[a].updateDisplay())}),!0}),m.set("Fighting Instinct","unit"),p.set("Fighting Instinct",function(e,t,n,a){return"Red"==v.lanes[t].cards[a][n].Color&&"Hero"==v.lanes[t].cards[a][n].CardType&&(v.lanes[t].cards[a][n].currentArmor[1]+=1,v.lanes[t].cards[a][n].currentAttack[1]+=1,v.lanes[t].cards[a][n].updateDisplay(),!0)}),m.set("Eclipse","lane"),p.set("Eclipse",function(e,t,n,a){let l=v.lanes[t],s=F.getTurn(),o=F.players[F.getTurn()].getHeros().find(function(e){return"Luna"==e.Name}).beams;if(o)for(var c=0;c<o;c++){let e=l.cards.reduce(i,[[],[]])[1-s];0!=e.length&&(e=e[Math.floor(Math.random()*e.length)],null!=(e=l.cards[e])[1-s].Name&&(e[1-s].currentHealth[0]-=3-(r(e[1-s].currentArmor)<0?r(e[1-s].currentArmor):0),l.collapse()))}return!0}),m.set("Sow Venom","lane"),p.set("Sow Venom",function(e,t){let n=[[],[]];t=v.lanes[t];for(let e=0;e<2;e++){let e=D(G.Cards.find(function(e){return"Plague Ward"==e.Name}),F.players[F.getTurn()]);n[F.getTurn()].push(e)}return t.summon(n),!0}),m.set("Mystic Flare","unit"),p.set("Mystic Flare",function(e,t,n,a){let l=v.lanes[t];for(var s=0;s<12;)for(var i=-1;i<=1;i++)null!=l.cards[a+i]&&null!=l.cards[a+i][n].Name&&(l.cards[a+i][n].currentHealth[0]-=2-r(l.cards[a+i][n].currentArmor),s+=2);for(i=-1;i<=1;i++)null!=l.cards[a+i]&&null!=l.cards[a+i][n].Name&&l.cards[a+i][n].updateDisplay();return l.collapse(),!0}),m.set("Coup de Grace","unit"),p.set("Coup de Grace",function(e,t,n,a){let r=v.lanes[t];if("Hero"!=r.cards[a][n].CardType)return!1;F.condemn(r.cards[a][n],v.lanes[t]),F.infoDisplayUpdate(),r.collapse();let l=F.players[F.getTurn()].hand;if(l.length>1){let e=Math.floor(Math.random()*l.length);l[e]==y&&(e=(e+1)%l.length),(e=l.splice(e,1)[0]).div.parentNode.removeChild(e.div)}return!0});const g=e=>{let t=document.createElement("div"),n=[void 0,void 0],a=[void 0,void 0],l=[],s=[[],[]],i=[document.createElement("div"),document.createElement("div")];i.forEach(function(e,n){e.classList.add("improvement",n?"top":"bottom"),t.appendChild(e)}),t.ondragover=function(e){e.preventDefault()},t.addEventListener("dragenter",function(e){e.target.classList.add("dragover")}),t.addEventListener("dragleave",function(e){e.target.classList.remove("dragover")}),t.ondrop=(e=>o(e));const o=t=>{t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]<y.ManaCost||e!=F.getCurrentLane()&&!y.CrossLane||"lane"!=m.get(y.Name)&&"Improvement"!=y.CardType||v.lanes[F.getCurrentLane()].cards.some(T)&&("Improvement"==y.CardType?(y.div.draggable=!1,s[F.getTurn()].push(y),i[F.getTurn()].appendChild(y.div)):(p.get(y.Name)(t,e),y.div.parentNode.removeChild(y.div)),v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]-=y.ManaCost,v.lanes[F.getCurrentLane()].towers[F.getTurn()].updateDisplay(),F.players[F.getTurn()].hand.splice(F.players[F.getTurn()].hand.indexOf(y),1),c(),d(),F.dispatchEvent("continuousRefresh"),F.nextTurn())},c=(t=!0)=>{l.flat().forEach(function(t){null!=t.currentHealth&&r(t.currentHealth)<=0&&F.condemn(t,v.lanes[e])});let n=!1;l.forEach(function(e,t){e.forEach(function(e,n){null!=e.Name&&null==l[t+e.arrow][1-n].Name&&(e.arrow=0)})}),l.forEach(function(e,t){null==e[0].Name&&null==e[1].Name&&(n=!0,e[0].div.parentNode.removeChild(e[0].div),e[1].div.parentNode.removeChild(e[1].div),l.splice(t,1))}),n?c(t):t&&F.dispatchEvent("continuousRefresh")},d=()=>{if(0==l.reduce(z,[[],[]])[F.getTurn()].length){let t=[w(e,a[0],l.length),w(e,a[1],l.length)],n=[w(e,a[0],0),w(e,a[1],0)];l.push(t),l.unshift(n)}};return{name:name,div:t,cards:l,towers:n,improvements:s,playAreas:a,stages:[],passCount:0,collapse:c,expand:d,summon:(t,n=!0)=>{t.forEach(function(t,n){for(;l.reduce(z,[[],[]])[n].length<t.length;){let t=Math.random()<.5;t=t?a[0].childNodes.length:0;let n=[w(e,a[0],t),w(e,a[1],t)];t?l.push(n):l.unshift(n)}}),t.forEach(function(t,a){t.forEach(function(t){let r=l.reduce(z,[[],[]])[a];r=r[Math.floor(Math.random()*r.length)];let s=l[r][a].div;s.parentNode.replaceChild(t.div,s),l[r][a]=t,t.arrow=0,null!=l[r][1-a].Name&&(l[r][1-a].arrow=0),n&&(t.rndArrow(e,r,a),F.dispatchEvent("continuousRefresh"))})})},drop:o}},v={div:document.getElementById("board"),lanes:[g(0),g(1),g(2)],collapse:()=>{v.lanes.forEach(function(e){e.collapse(!1)}),F.dispatchEvent("continuousRefresh")}};let y,C=new Map,E=new Map;function A(e,t,n,a,r=!0){let l=e.Abilities.findIndex(function(e){return console.log(e.div,t),e.div==t});e.Abilities[l].div.classList.add("glow"),F.div.classList.add("target"),F.div.addEventListener("click",function t(s){s.stopPropagation();let i=s.path||s.composedPath&&s.composedPath();i||console.log("no path");e:{let t,s=i.find(function(e){if(e.classList)return e.classList.contains("lane")});if(void 0!=s){if(s=v.lanes.find(function(e){return e.div==s}),"card"==n||"empty"==n){if(void 0==(t=i.find(function(e){if(e.classList)return e.classList.contains("playarea")})))break e;t=s.playAreas.findIndex(function(e){return e==t})}else if("tower"==n){if(void 0==(t=i.find(function(e){if(e.classList)return e.classList.contains("tower")})))break e;t=s.towers.findIndex(function(e){return e.div==t})}if("card"==n){if(void 0==(n=i.find(function(e){if(e.classList)return e.classList.contains("card")})))break e;n=s.cards.findIndex(function(e){return e[t].div==n})}else if("empty"==n){if(void 0==(n=i.find(function(e){if(e.classList)return e.classList.contains("blank")})))break e;n=s.cards.findIndex(function(e){return e[t].div==n})}else"tower"==n&&(n=t);r(s,t,n)&&(a(s,t,n),e.Abilities[l].currentCooldown=e.Abilities[l].Cooldown,e.updateDisplay(),F.nextTurn())}}F.div.classList.remove("target"),e.Abilities[l].div.classList.remove("glow"),F.div.removeEventListener("click",t,!0)},!0)}function L(e,t){return e=function(){let n=e;return function(){t(),n.apply(this)}}()}C.set("testAbility",function(){console.log("testAbility")}),E.set("Pack Leadership","continuousEffect"),C.set("Pack Leadership",function(e,t){for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentArmor[4]+=1,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Wisdom of the Elders","click"),C.set("Wisdom of the Elders",function(e,t){return e.player.draw(),!0}),E.set("Work the Knife","whenAttacking"),C.set("Work the Knife",function(e,t){let n=v.lanes[t.detail.lane],a=t.detail.card+e.arrow;null!=n.cards[a]&&null!=n.cards[a][1-t.detail.player].Name&&"Creep"==n.cards[a][1-t.detail.player].CardType||(e.currentAttack[4]+=2)}),E.set("Call of the Wild","click"),C.set("Call of the Wild",function(e,t){let n=[[],[]],a=v.lanes[F.getCurrentLane()],r=D(G.Cards.find(function(e){return"Loyal Beast"==e.Name}),F.players[F.getTurn()]);return n[F.getTurn()].push(r),a.summon(n),!0}),E.set("Return","continuousEffect"),C.set("Return",function(e,t){e.retaliate[4]+=2}),E.set("Moment of Courage","continuousEffect"),C.set("Moment of Courage",function(e,t){e.retaliate[4]+=2}),E.set("Concussive Shot","click"),C.set("Concussive Shot",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentArmor[3]-=2,e.cards[n][t].updateDisplay(),null!=e.cards[n-1]&&null!=e.cards[n-1][t].Name&&(e.cards[n-1][t].currentArmor[3]-=2,e.cards[n-1][t].updateDisplay()),null!=e.cards[n+1]&&null!=e.cards[n+1][t].Name&&(e.cards[n+1][t].currentArmor[3]-=2,e.cards[n+1][t].updateDisplay())},function(e,t,n){return e==v.lanes[F.getCurrentLane()]}),!1}),E.set("Nature's Attendants","continuousEffect"),C.set("Nature's Attendants",function(e,t){e.regen[4]+=2,e.updateDisplay();for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].regen[4]+=2,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Branches of Iron","continuousEffect"),C.set("Branches of Iron",function(e,t){for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentArmor[4]+=2,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Feral Impulse","continuousEffect"),C.set("Feral Impulse",function(e,t){for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentAttack[4]+=2,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Arctic Burn","afterCardPlayed"),C.set("Arctic Burn",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a]==e});return A(e,t.currentTarget,"empty",function(t,l,s){e.currentAttack[3]+=4;let i=r>s?e.div.nextSibling:t.cards[s][l].div.nextSibling;r>s?t.cards[s][l].div.parentNode.insertBefore(e.div,t.cards[s][l].div):e.div.parentNode.insertBefore(t.cards[s][l].div,e.div),r>s?e.div.parentNode.insertBefore(t.cards[s][l].div,i):t.cards[s][l].div.parentNode.insertBefore(e.div,i);let o=t.cards[s][l];t.cards[s][l]=n.cards[r][a],n.cards[r][a]=o,null!=t.cards[s][1-l].Name&&(t.cards[s][1-l].arrow=0,e.arrow=0,t.cards[s][1-l].updateDisplay()),e.updateDisplay(),n.collapse()},function(e,t,r){return e==n&&a==t}),!1}),E.set("Nether Blast","click"),C.set("Nether Blast",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn();n.cards.findIndex(function(t){return t[a]==e});if(n.improvements[1-a].length){let e=Math.floor(Math.random()*n.improvements[1-a].length);return(e=n.improvements[1-a].splice(e)[0]).div.parentNode.removeChild(e.div),!0}return!1}),E.set("Great Cleave","continuousEffect"),C.set("Great Cleave",function(e,t){e.cleave[4]+=Math.floor(r(e.currentAttack)/2)}),E.set("Lucent Beam","beforeTheActionPhase"),C.set("Lucent Beam",function(e,t){let n=v.lanes[t.detail.lane],a=n.cards.reduce(i,[[],[]])[1-t.detail.player];0!=a.length&&(a=a[Math.floor(Math.random()*a.length)],null!=(a=n.cards[a])[1-t.detail.player].Name&&(e.beams=e.beams||0,e.beams+=1,a[1-t.detail.player].currentHealth[0]-=1-(r(a[1-t.detail.player].currentArmor)<0?r(a[1-t.detail.player].currentArmor):0),n.collapse()))}),E.set("Bringer of the Faithful","endOfRound"),C.set("Bringer of the Faithful",function(e,t){null!=t.detail.lane&&F.extraDeploy[t.detail.player][t.detail.lane].push(D(G.Cards[132],F.players[t.detail.player]))}),E.set("Venomous Nature","endOfRound"),C.set("Venomous Nature",function(e,t){null!=t.detail.lane&&F.extraDeploy[t.detail.player][t.detail.lane].push(D(G.Cards.find(function(e){return"Plague Ward"==e.Name}),F.players[t.detail.player]))}),E.set("Jinada","beforeTheActionPhase"),C.set("Jinada",function(e,t){Math.random()<.5&&(e.currentAttack[3]+=4,e.updateDisplay())}),E.set("Sacrifice","click"),C.set("Sacrifice",function(e,t){return A(e,t.currentTarget,"card",function(t,n,a){e.player.draw(),r(t.cards[a][n].currentAttack)>=6&&e.player.draw(),F.condemn(t.cards[a][n],t),F.infoDisplayUpdate(),t.collapse()},function(t,n,a){return t==v.lanes[F.getCurrentLane()]&&F.getTurn()==n&&t.cards[a][n]!=e}),!1}),E.set("Finger of Death","click"),C.set("Finger of Death",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentHealth[0]-=8-(r(e.cards[n][t].currentArmor)<0?r(e.cards[n][t].currentArmor):0),e.cards[n][t].updateDisplay(),e.collapse()},function(e,t,n){return e==v.lanes[F.getCurrentLane()]}),!1}),E.set("Efficient Killer","whenAttacking"),C.set("Efficient Killer",function(e,t){let n=v.lanes[t.detail.lane],a=t.detail.card+e.arrow;null!=n.cards[a]&&null!=n.cards[a][1-t.detail.player].Name&&"Hero"==n.cards[a][1-t.detail.player].CardType&&(e.currentAttack[4]+=4)}),E.set("Warmonger","whenAttacking"),C.set("Warmonger",function(e,t){let n=v.lanes[t.detail.lane],a=t.detail.card+e.arrow;null!=n.cards[a]&&null!=n.cards[a][1-t.detail.player].Name||(e.currentAttack[4]+=4)}),E.set("Precision Aura","continuousEffect"),C.set("Precision Aura",function(e,t){v.lanes.forEach(function(n){n.cards.forEach(function(n){null!=n[t.detail.player].Name&&n[t.detail.player]!=e&&(n[t.detail.player].currentAttack[4]+=1,n[t.detail.player].updateDisplay())})})}),E.set("Purification","click"),C.set("Purification",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentHealth[0]+=3,e.cards[n][t].currentHealth[0]>e.cards[n][t].Health&&(e.cards[n][t].currentHealth[0]=e.cards[n][t].Health),e.cards[n][t].updateDisplay()},function(e,t,n){return e==v.lanes[F.getCurrentLane()]}),!1}),E.set("Barracks : Effect","endOfRound"),C.set("Barracks : Effect",function(e,t){null!=t.detail.lane&&F.extraDeploy[t.detail.player][t.detail.lane].push(D(G.Cards[132],F.players[t.detail.player]))}),E.set("Ignite : Effect","beforeTheActionPhase"),C.set("Ignite : Effect",function(e,t){let n=v.lanes[t.detail.lane];n.cards.forEach(function(e){null!=e[1-t.detail.player].Name&&(e[1-t.detail.player].currentHealth[0]-=1-(r(e[1-t.detail.player].currentArmor)<0?r(e[1-t.detail.player].currentArmor):0))}),n.collapse()}),E.set("Conflagration : Effect","beforeTheActionPhase"),C.set("Conflagration : Effect",function(e,t){let n=v.lanes[t.detail.lane];n.cards.forEach(function(e){null!=e[1-t.detail.player].Name&&(e[1-t.detail.player].currentHealth[0]-=2-r(e[1-t.detail.player].currentArmor))}),n.collapse()}),E.set("Burning Oil : Effect","continuousEffect"),C.set("Burning Oil : Effect",function(e,t){}),E.set("Assault Ladders : Effect","whenAttacking"),C.set("Assault Ladders : Effect",function(e,t){let n=v.lanes[t.detail.lane];n.cards.forEach(function(e,a){null!=e[t.detail.player].Name&&(null!=n.cards[a+e[t.detail.player].arrow]&&null!=n.cards[a+e[t.detail.player].arrow][1-t.detail.player].Name||(n.cards[a][t.detail.player].currentAttack[4]+=2))})}),E.set("Mist of Avernus : Effect","beforeTheActionPhase"),C.set("Mist of Avernus : Effect",function(e,t){v.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&(e[t.detail.player].currentAttack[1]+=1,e[t.detail.player].updateDisplay())})}),E.set("Altar of the Mad Moon : Effect","continuousEffect"),C.set("Altar of the Mad Moon : Effect",function(e,t){v.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&"Creep"==e[t.detail.player].CardType&&(e[t.detail.player].regen[4]+=2,e[t.detail.player].updateDisplay())})}),E.set("Verdant Refuge : Effect","continuousEffect"),C.set("Verdant Refuge : Effect",function(e,t){v.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&(e[t.detail.player].currentArmor[4]+=1,e[t.detail.player].updateDisplay())})}),E.set("Steam Cannon : Effect","click"),C.set("Steam Cannon : Effect",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentHealth[0]-=4-(r(e.cards[n][t].currentArmor)<0?r(e.cards[n][t].currentArmor):0),e.collapse()},function(){return!0}),!1}),E.set("Keenfolk Turret : Effect","click"),C.set("Keenfolk Turret : Effect",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentHealth[0]-=2-(r(e.cards[n][t].currentArmor)<0?r(e.cards[n][t].currentArmor):0),e.collapse()},function(e,t,n){return e==v.lanes[F.getCurrentLane()]}),!1}),E.set("Assassin's Apprentice : Effect","click"),C.set("Assassin's Apprentice : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a]==e});return A(e,t.currentTarget,"card",function(t,n,a){e.arrow=a-r},function(e,t,l){return e==n&&a!=t&&Math.abs(l-r)<=1}),!1}),E.set("Sister of the Veil : Effect","click"),C.set("Sister of the Veil : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a]==e});return A(e,t.currentTarget,"card",function(t,n,a){e.arrow=a-r},function(e,t,l){return e==n&&a!=t&&Math.abs(l-r)<=1}),!1}),E.set("Rebel Decoy : Effect","click"),C.set("Rebel Decoy : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a]==e});return A(e,t.currentTarget,"card",function(t,l,s){let i=r>s?e.div.nextSibling:t.cards[s][l].div.nextSibling;r>s?t.cards[s][l].div.parentNode.insertBefore(e.div,t.cards[s][l].div):e.div.parentNode.insertBefore(t.cards[s][l].div,e.div),r>s?e.div.parentNode.insertBefore(t.cards[s][l].div,i):t.cards[s][l].div.parentNode.insertBefore(e.div,i);let o=t.cards[s][l];t.cards[s][l]=n.cards[r][a],n.cards[r][a]=o,null!=n.cards[r][1-a].Name&&(n.cards[r][a].arrow=0,n.cards[r][a].updateDisplay()),null!=t.cards[s][1-l].Name&&(t.cards[s][l].arrow=0,t.cards[s][l].updateDisplay())},function(e,t,r){return e==n&&a==t}),!1}),E.set("Troll Soothsayer : Effect","endOfRound"),C.set("Troll Soothsayer : Effect",function(e,t){e.player.draw()}),E.set("Legion Standard Bearer : Effect","continuousEffect"),C.set("Legion Standard Bearer : Effect",function(e,t){for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentAttack[4]+=4,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Mercenary Exiles : Effect","click"),C.set("Mercenary Exiles : Effect",function(e,t){let n=Math.floor(e.player.gold/2);return e.player.gold=0,e.currentAttack[1]+=n,e.currentHealth[1]+=n,e.updateDisplay(),F.infoDisplayUpdate(),!0}),E.set("Satyr Magician : Effect","click"),C.set("Satyr Magician : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()].towers[F.getTurn()];return n.mana[0]=n.mana[1],n.updateDisplay(),!0}),E.set("Disciple of Nevermore : Effect","continuousEffect"),C.set("Disciple of Nevermore : Effect",function(e,t){let n=v.lanes[t.detail.lane];n.cards.forEach(function(e){null!=e[t.detail.player].Name&&n.cards[t.detail.card]!=e&&(e[t.detail.player].currentArmor[4]-=2,e[t.detail.player].currentAttack[4]+=2,e[t.detail.player].updateDisplay())})}),E.set("Ravenous Mass : Effect","click"),C.set("Ravenous Mass : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),l=n.cards.findIndex(function(t){return t[a]==e});for(var s=-1;s<2;s+=2)null!=n.cards[l+s]&&null!=n.cards[l+s][a].Name&&(e.currentAttack[1]+=r(n.cards[l+s][a].currentAttack),e.currentHealth[1]+=r(n.cards[l+s][a].currentHealth),F.condemn(n.cards[l+s][a],n));return n.collapse(),!0}),E.set("Rampaging Hellbear : Effect","afterCombat"),C.set("Rampaging Hellbear : Effect",function(e,t){e.currentAttack[1]+=4,e.updateDisplay()}),E.set("Savage Wolf : Effect","afterCombat"),C.set("Savage Wolf : Effect",function(e,t){e.currentAttack[1]+=1,e.currentHealth[1]+=2,e.updateDisplay()}),E.set("Satyr Duelist : Effect","afterCombat"),C.set("Satyr Duelist : Effect",function(e,t){e.currentAttack[1]+=2,e.updateDisplay()}),E.set("Savage Wolf : Effect","afterCombat"),C.set("Savage Wolf : Effect",function(e,t){e.currentAttack[1]+=1,e.currentHealth[1]+=2,e.updateDisplay()}),E.set("Selfish Cleric : Effect","afterCombat"),C.set("Selfish Cleric : Effect",function(e,t){e.currentHealth[0]=e.Health,e.updateDisplay()}),E.set("Revtel Convoy : Effect","continuousEffect"),C.set("Revtel Convoy : Effect",function(e,t){let n=Math.floor(e.player.gold/2);e.currentAttack[4]+=n,e.updateDisplay()}),E.set("Thunderhide Pack : Effect","continuousEffect"),C.set("Thunderhide Pack : Effect",function(e,t){e.siege[4]+=6,e.updateDisplay()}),E.set("Emissary of the Quorum : Effect","click"),C.set("Emissary of the Quorum : Effect",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn();return n.cards.forEach(function(e){null!=e[a].Name&&(e[a].currentAttack[1]+=2,e[a].currentHealth[1]+=2,e[a].updateDisplay())}),!0}),E.set("Plague Ward : Effect","beforeTheActionPhase"),C.set("Plague Ward : Effect",function(e,t){let n=v.lanes[t.detail.lane],a=t.detail.card-1<0?0:t.detail.card-1;console.log(n.cards.slice(a,t.detail.card+2));let l=n.cards.slice(a,t.detail.card+2).reduce(i,[[],[]])[1-t.detail.player];console.log(l,a),0!=l.length&&(l=l[Math.floor(Math.random()*l.length)]+a,null!=(l=n.cards[l])[1-t.detail.player].Name&&(l[1-t.detail.player].currentHealth[0]-=2-(r(l[1-t.detail.player].currentArmor)<0?r(l[1-t.detail.player].currentArmor):0),l[1-t.detail.player].updateDisplay()))}),E.set("Prowler Vanguard : Effect","continuousEffect"),C.set("Prowler Vanguard : Effect",function(e,t){for(var n=-1;n<2;n+=2){let e=v.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentArmor[4]+=1,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Leather Armor : Effect","continuousEffect"),C.set("Leather Armor : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentArmor[4]+=1,n.updateDisplay()}),E.set("Traveler's Cloak : Effect","continuousEffect"),C.set("Traveler's Cloak : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentHealth[4]+=4,n.updateDisplay()}),E.set("Short Sword : Effect","continuousEffect"),C.set("Short Sword : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentAttack[4]+=2,n.updateDisplay()}),E.set("Demagicking Maul : Effect","continuousEffect"),C.set("Demagicking Maul : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentAttack[4]+=2,n.updateDisplay()}),E.set("Demagicking Maul : EffectActive","click"),C.set("Demagicking Maul : EffectActive",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a].Weapon==e});if(null==n.cards[r+n.cards[r][a].arrow][1-a].Name&&n.improvements[1-a].length){let e=Math.floor(Math.random()*n.improvements[1-a].length);return(e=n.improvements[1-a].splice(e)[0]).div.parentNode.removeChild(e.div),!0}return!1}),E.set("Stonehall Plate : Effect","continuousEffect"),C.set("Stonehall Plate : Effect",function(e,t){e.stonehall||(e.div.addEventListener("afterCombat",function(){e.Armor=e.Armor||1,e.Armor+=1}),e.stonehall=!0);let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];e.Armor=e.Armor||1,n.currentArmor[4]+=e.Armor,n.updateDisplay()}),E.set("Stonehall Cloak : Effect","continuousEffect"),C.set("Stonehall Cloak : Effect",function(e,t){e.stonehall||(e.div.addEventListener("afterCombat",function(){e.Health=e.Health||4,e.Health+=2}),e.stonehall=!0);let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];e.Health=e.Health||4,n.currentHealth[4]+=e.Health,n.updateDisplay()}),E.set("Blade of the Vigil : Effect","continuousEffect"),C.set("Blade of the Vigil : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentAttack[4]+=2,n.cleave[4]+=2,n.updateDisplay()}),E.set("Keenfolk Musket : Effect","continuousEffect"),C.set("Keenfolk Musket : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentAttack[4]+=2,n.updateDisplay()}),E.set("Keenfolk Musket : EffectActive","click"),C.set("Keenfolk Musket : EffectActive",function(e,t){return A(e,t.currentTarget,"card",function(e,t,n){e.cards[n][t].currentHealth[0]-=2-r(e.cards[n][t].currentArmor),e.collapse()},function(e,t,n){return e==v.lanes[F.getCurrentLane()]}),!1}),E.set("Red Mist Maul : Effect","continuousEffect"),C.set("Red Mist Maul : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentAttack[4]+=2,n.siege[4]+=5,n.updateDisplay()}),E.set("Shield of Basilius : Effect","continuousEffect"),C.set("Shield of Basilius : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentArmor[4]+=2,n.updateDisplay();for(var a=-1;a<2;a+=2){let e=v.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentArmor[4]+=1,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Horn of the Alpha : Effect","continuousEffect"),C.set("Horn of the Alpha : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentHealth[4]+=4,n.updateDisplay()}),E.set("Horn of the Alpha : EffectActive","click"),C.set("Horn of the Alpha : EffectActive",function(e,t){let n=[[],[]],a=v.lanes[F.getCurrentLane()],r=D(G.Cards.find(function(e){return"Thunderhide Pack"==e.Name}),F.players[F.getTurn()]);return n[F.getTurn()].push(r),a.summon(n),!0}),E.set("Ring of Tarrasque : Effect","continuousEffect"),C.set("Ring of Tarrasque : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentHealth[4]+=4,n.regen[4]+=6,n.updateDisplay()}),E.set("Phase Boots : Effect","continuousEffect"),C.set("Phase Boots : Effect",function(e,t){let n=v.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];n.currentHealth[4]+=4,n.updateDisplay()}),E.set("Phase Boots : EffectActive","click"),C.set("Phase Boots : EffectActive",function(e,t){let n=v.lanes[F.getCurrentLane()],a=F.getTurn(),r=n.cards.findIndex(function(t){return t[a].Accessory==e});console.log(r);let l=n.cards[r][a];return A(e,t.currentTarget,"card",function(e,t,s){let i=r>s?l.div.nextSibling:e.cards[s][t].div.nextSibling;r>s?e.cards[s][t].div.parentNode.insertBefore(l.div,e.cards[s][t].div):l.div.parentNode.insertBefore(e.cards[s][t].div,l.div),r>s?l.div.parentNode.insertBefore(e.cards[s][t].div,i):e.cards[s][t].div.parentNode.insertBefore(l.div,i);let o=e.cards[s][t];e.cards[s][t]=n.cards[r][a],n.cards[r][a]=o,null!=n.cards[r][1-a].Name&&(n.cards[r][a].arrow=0,n.cards[r][a].updateDisplay()),null!=e.cards[s][1-t].Name&&(e.cards[s][t].arrow=0,e.cards[s][t].updateDisplay())},function(e,t,r){return e==n&&a==t}),!1});const T=e=>{if("Hero"==e[F.getTurn()].CardType)return e[F.getTurn()].Color==y.Color},w=(e,t,n)=>{let a=document.createElement("div");a.classList.add("blank"),null!=t&&(n?t.insertBefore(a,t.childNodes[n-1].nextSibling):t.insertBefore(a,t.firstChild)),a.ondragover=function(e){e.preventDefault()},a.ondragenter=function(e){e.target.classList.add("dragover")},a.ondragleave=function(e){e.target.classList.remove("dragover")},a.ondrop=(e=>r(e));const r=t=>{if(t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),!(v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]<y.ManaCost)&&e==F.getCurrentLane()&&"Creep"==y.CardType&&v.lanes[F.getCurrentLane()].cards.some(T)){let t=v.lanes[e].cards.flat().findIndex(function(e){return e.div==l.div}),n=t%2;t=Math.floor(t/2),n==F.getTurn()&&(y.div.draggable=!1,a.parentNode.replaceChild(y.div,a),v.lanes[e].cards[t][n]=y,v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]-=y.ManaCost,v.lanes[F.getCurrentLane()].towers[F.getTurn()].updateDisplay(),null!=v.lanes[e].cards[t][1-n].Name&&(v.lanes[e].cards[t][1-n].arrow=0,v.lanes[e].cards[t][1-n].updateDisplay()),F.players[F.getTurn()].hand.splice(F.players[F.getTurn()].hand.indexOf(y),1),v.lanes[e].collapse(),v.lanes[e].expand(),F.dispatchEvent("continuousRefresh"),F.nextTurn())}};let l={div:a,drop:r};return{div:a,drop:r}},D=(e,t)=>{let n="../node_modules/artifactdb/assets",a=document.createElement("div"),l=()=>{},s=()=>{},i=()=>{},o=()=>{},c={div:a,player:t};a.classList.add("card",e.Color,e.CardType);let d=document.createElement("IMG");if(d.draggable=!1,d.src=`${n}/artwork/large/${e.fileName}.jpg`,a.appendChild(d),"Hero"==e.CardType&&(c.respawn=0,c.Bounty=5),"Creep"==e.CardType&&(c.Bounty=1),null!=e.ManaCost){let t=document.createElement("div");t.classList.add("mana-cost"),t.textContent=e.ManaCost,a.appendChild(t)}if("Consumable"==e.ItemType&&(e.ManaCost=0),null!=e.GoldCost){let t=document.createElement("div");t.classList.add("gold-cost"),t.textContent=e.GoldCost,a.appendChild(t)}if(null!=e.Text&&""!=e.Text){let t=document.createElement("div");t.classList.add("card-text");let r=document.createElement("IMG");r.draggable=!1,r.src=`${n}/text_background.jpg`;let l=document.createElement("span");l.textContent=e.Text,a.appendChild(t),t.appendChild(r),t.appendChild(l)}let u=document.createElement("div");if(u.classList.add("name"),u.textContent=e.Name,a.appendChild(u),"Hero"==e.CardType){var f=document.createElement("div");f.classList.add("items"),a.appendChild(f),c.Weapon=null;var h=document.createElement("div");h.classList.add("Weapon"),f.appendChild(h),c.Armor=null;var g=document.createElement("div");g.classList.add("Armor"),f.appendChild(g),c.Accessory=null;var A=document.createElement("div");A.classList.add("Accessory"),f.appendChild(A)}if("Creep"==e.CardType||"Hero"==e.CardType){c.arrow=0;let t=["left","middle","right"],d=document.createElement("div");d.classList.add("arrow",t[1+c.arrow]),a.appendChild(d),c.rndArrow=((t,n,a)=>{if("number"==typeof t&&(t=v.lanes[t]),null==t.cards[n][1-a].Name){let r=Math.random();r=r>.75?1:(r>.25)-1,null!=t.cards[n+r]&&null!=t.cards[n+r][1-a].Name||(r=0),e.arrow=r}e.updateDisplay()}),l=L(l,function(){d.classList.remove("left","middle","right"),d.classList.add("arrow",t[1+e.arrow])}),c.cleave=[0,0,0,0,0,0],c.retaliate=[0,0,0,0,0,0],c.siege=[0,0,0,0,0,0],c.regen=[0,0,0,0,0,0],l=L(l,function(){a.title=`Cleave : ${r(e.cleave)}\nRetaliate : ${r(e.retaliate)}\nSiege : ${r(e.siege)}\nRegeneration : ${r(e.regen)}`,r(e.cleave)>0?d.classList.add("cleave"):d.classList.remove("cleave"),r(e.retaliate)>0?a.classList.add("retaliate"):a.classList.remove("retaliate"),r(e.siege)>0?d.classList.add("siege"):d.classList.remove("siege")}),s=L(s,function(){e.cleave[3]=0,e.retaliate[3]=0,e.siege[3]=0,e.regen[3]=0}),o=L(o,function(){e.cleave[4]=0,e.retaliate[4]=0,e.siege[4]=0,e.regen[4]=0}),i=L(i,function(){e.cleave[5]=0,e.retaliate[5]=0,e.siege[5]=0,e.regen[5]=0}),c.currentHealth=[e.Health,0,0,0,0,0];let u=document.createElement("div");u.classList.add("icon-container","health");let f=document.createElement("IMG");f.draggable=!1,f.src=`${n}/icon/cardstat-health.png`;let p=document.createElement("div");p.textContent=r(c.currentHealth),u.appendChild(f),u.appendChild(p),a.appendChild(u),l=L(l,function(){p.textContent=r(e.currentHealth)}),s=L(s,function(){e.currentHealth[3]=0}),o=L(o,function(){e.currentHealth[4]=0}),i=L(i,function(){e.currentHealth[5]=0}),c.currentAttack=[e.Attack,0,0,0,0,0];let m=document.createElement("div");m.classList.add("icon-container","attack");let h=document.createElement("IMG");h.draggable=!1,h.src=`${n}/icon/cardstat-attack.png`;let g=document.createElement("div");g.textContent=e.Attack,m.appendChild(h),m.appendChild(g),a.appendChild(m),l=L(l,function(){g.textContent=r(e.currentAttack)}),s=L(s,function(){e.currentAttack[3]=0}),o=L(o,function(){e.currentAttack[4]=0}),i=L(i,function(){e.currentAttack[5]=0}),c.currentArmor=[e.Armor,0,0,0,0,0];let y=document.createElement("div");y.classList.add("icon-container","armor");let C=document.createElement("IMG");C.draggable=!1,C.src=`${n}/icon/cardstat-armor.png`;let E=document.createElement("div");E.textContent=e.Armor,y.appendChild(C),y.appendChild(E),a.appendChild(y),l=L(l,function(){E.textContent=r(e.currentArmor)}),s=L(s,function(){e.currentArmor[3]=0}),o=L(o,function(){e.currentArmor[4]=0}),i=L(i,function(){e.currentArmor[5]=0})}if(null!=e.Abilities){c.Abilities=[];let r=document.createElement("div");r.classList.add("abilities-container"),e.Abilities.forEach(function(i,o){(i=Object.assign({},i)).div=document.createElement("div"),i.div.classList.add("ability-container");let d=document.createElement("IMG");if(d.draggable=!1,"Hero"==e.CardType){let e=function(e){return e.replace(" : Effect","").replace(/\s/g,"_").replace("'","-").toLowerCase()}(i.Name);d.src=`${n}/ability/${e}.jpg`}else o>0&&(i.Name=i.Name+i.Type),d.src=`${n}/artwork/small/${e.fileName}.jpg`;d.title=i.Text,i.div.appendChild(d),r.appendChild(i.div),"Active"==i.Type?(i.div.classList.add("Active"),"Hero"==e.CardType?i.currentCooldown=i.Cooldown:i.currentCooldown=0,i.cooldownDiv=document.createElement("div"),i.cooldownDiv.classList.add("cooldown","display-none"),i.cooldownDiv.textContent=i.currentCooldown,i.div.appendChild(i.cooldownDiv),i.div.addEventListener("click",function(n){F.players[F.getTurn()]==t&&F.getCurrentLane()==("Improvement"==e.CardType?v.lanes.findIndex(function(t){return t.improvements.flat().some(function(t){return t.div==e.div})}):"Item"!=e.CardType?v.lanes.findIndex(function(t){return t.cards.flat().some(function(t){return t.div==e.div})}):"Weapon"==e.ItemType?v.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Weapon)return t.Weapon.div==e.div})}):"Armor"==e.ItemType?v.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Armor)return t.Armor.div==e.div})}):"Accessory"==e.ItemType?v.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Accessory)return t.Accessory.div==e.div})}):void 0)&&e.Abilities[o].currentCooldown<=0&&C.get(i.Name)(e,n)&&(e.Abilities[o].currentCooldown=e.Abilities[o].Cooldown,l(),F.nextTurn())}),s=L(s,function(){e.Abilities[o].currentCooldown-=1}),l=L(l,function(){e.Abilities[o].currentCooldown<=0?e.Abilities[o].cooldownDiv.classList.add("display-none"):(e.Abilities[o].cooldownDiv.classList.remove("display-none"),e.Abilities[o].cooldownDiv.textContent=e.Abilities[o].currentCooldown)})):a.addEventListener(E.get(i.Name),function(t){C.get(i.Name)(e,t)}),c.Abilities.push(i)}),a.appendChild(r)}return a.ondragover=function(e){e.preventDefault()},a.addEventListener("dragenter",function(e){e.target.classList.add("dragover")}),a.addEventListener("dragleave",function(e){e.target.classList.remove("dragover")}),a.ondrop=(e=>c.drop(e)),c.drop=(t=>{if(t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]>=y.ManaCost){let e=v.lanes.findIndex(function(e){return e.div==t.currentTarget.parentNode.parentNode});if((e==F.getCurrentLane()||y.CrossLane)&&"unit"==m.get(y.Name)&&(v.lanes[F.getCurrentLane()].cards.some(T)||"Item"==y.CardType)){let n=v.lanes[e].cards.flat().findIndex(function(e){return e.div==t.currentTarget}),a=n%2;n=Math.floor(n/2),p.get(y.Name)(t,e,a,n)&&(y.div.draggable=!1,v.lanes[F.getCurrentLane()].towers[F.getTurn()].mana[0]-=y.ManaCost,v.lanes[F.getCurrentLane()].towers[F.getTurn()].updateDisplay(),y.div.parentNode.removeChild(y.div),F.players[F.getTurn()].hand.splice(F.players[F.getTurn()].hand.indexOf(y),1),F.dispatchEvent("continuousRefresh"),F.nextTurn())}}else if("Hero"==e.CardType&&"Item"==y.CardType){v.lanes.findIndex(function(e){return e.div==t.currentTarget.parentNode.parentNode})==F.getCurrentLane()&&("Armor"==y.ItemType&&(e.Armor&&g.removeChild(g.firstChild),e.Armor=y,g.appendChild(y.div)),"Accessory"==y.ItemType&&(e.Accessory&&A.removeChild(A.firstChild),e.Accessory=y,A.appendChild(y.div)),"Weapon"==y.ItemType&&(e.Weapon&&h.removeChild(h.firstChild),e.Weapon=y,h.appendChild(y.div)),F.dispatchEvent("continuousRefresh"),F.nextTurn())}}),a.addEventListener("click",function(){console.log(e)}),a.ondragstart=function(t){y=e,null!=t.dataTransfer&&t.dataTransfer.setData("text/plain"," ")},a.addEventListener("endOfRound",s),a.addEventListener("afterCombat",i),a.addEventListener("continuousRefresh",o),c.updateDisplay=l,e=Object.assign({},e,c)};var k=(()=>{const e=document.getElementById("zoom-btn"),t=document.getElementById("zoom-btn-left"),n=document.getElementById("zoom-btn-middle"),a=document.getElementById("zoom-btn-right");e.addEventListener("click",function(){v.div.classList.toggle("zoom-out"),F.div.classList.toggle("zoom-out"),v.lanes[F.getCurrentLane()].div.scrollIntoView({inline:"center"})}),t.addEventListener("click",function(){v.div.classList.remove("zoom-out"),F.div.classList.remove("zoom-out"),v.lanes[0].div.scrollIntoView({inline:"center"})}),n.addEventListener("click",function(){v.div.classList.remove("zoom-out"),F.div.classList.remove("zoom-out"),v.lanes[1].div.scrollIntoView({inline:"center"})}),a.addEventListener("click",function(){v.div.classList.remove("zoom-out"),F.div.classList.remove("zoom-out"),v.lanes[2].div.scrollIntoView({inline:"center"})});return{updateActive:()=>{switch(F.getCurrentLane()){case 0:t.classList.add("active"),n.classList.remove("active"),a.classList.remove("active");break;case 1:t.classList.remove("active"),n.classList.add("active"),a.classList.remove("active");break;case 2:t.classList.remove("active"),n.classList.remove("active"),a.classList.add("active")}}}})();var b=(()=>{const e=document.getElementById("pass-btn-bottom"),t=document.getElementById("pass-btn-top"),n=()=>{e.classList.add("display-none"),t.classList.add("display-none")};return n(),setTimeout(function(){e.onclick=F.pass,t.onclick=F.pass},100),{enable:()=>{F.getTurn()?t.disabled=!1:e.disabled=!1,F.getTurn()?e.disabled=!0:t.disabled=!0},disable:()=>{e.disabled=!0,t.disabled=!0},hide:n,show:()=>{e.classList.remove("display-none"),t.classList.remove("display-none")}}})();var N=(()=>{let e=[],t=[];return{initialize:()=>{e=[F.players[0].hand,F.players[1].hand],t=[F.players[0].handDiv,F.players[1].handDiv]},enable:()=>{e[F.getTurn()].forEach(function(e){e.div.draggable=!0}),e[1-F.getTurn()].forEach(function(e){e.div.draggable=!1})},disable:()=>{for(var t=0;t<e.length;t++)e[t].forEach(function(e){e.div.draggable=!1})},hide:()=>{for(var n=0;n<e.length;n++)t[n].classList.add("hide")},show:()=>{for(var n=0;n<e.length;n++)t[n].classList.remove("hide")}}})();const S=[],M=document.createElement("button");let B=[];function H(e){e.preventDefault()}function I(e){e.target.classList.add("dragover")}function x(e){e.target.classList.remove("dragover")}function R(){const e=document.createElement("div");e.classList.add("bottom","display-none");const t=document.createElement("div");t.classList.add("top","display-none"),S.push(e),S.push(t),S.forEach(function(e){e.classList.add("stage","UI"),F.div.appendChild(e)}),M.classList.add("deploy-btn","btn","UI","display-none"),M.textContent="Deploy",F.div.appendChild(M),M.addEventListener("click",function(){S[0].hasChildNodes()||S[1].hasChildNodes()?alert("Need to choose lanes for all Heros"):function(){(function(){for(let e=0;e<2;e++)S[e].classList.add("display-none"),v.lanes.forEach(function(t){t.stages[e].classList.add("display-none")})})(),M.classList.add("display-none");for(let e=0;e<3;e++){let t=v.lanes[e];t.summon([B[0][e],B[1][e]],!1),0!=F.getRound()&&t.cards.forEach(function(e,n){e.forEach(function(e,a){null!=e.Name&&e.rndArrow(t,n,a)})})}F.dispatchEvent("continuousRefresh"),F.players.forEach(function(e){e.draw(),e.draw()}),F.nextTurn(),F.dispatchEvent("beforeTheActionPhase"),b.show(),N.show()}()}),v.lanes.forEach(function(e,t){e.stages.forEach(function(e,n){e.ondragover=H,e.ondragenter=I,e.ondragleave=x,e.ondrop=function(a){a.preventDefault(),x(a),y.player==F.players[n]&&"Hero"==y.CardType&&(e.appendChild(y.div),B[n][t].push(y),y.div.draggable=!1)}})})}function P(){B[0]=[[],[],[]],B[1]=[[],[],[]],null==S[0]&&R(),v.div.classList.add("zoom-out"),F.div.classList.add("zoom-out"),function(){for(let e=0;e<2;e++)S[e].classList.remove("display-none"),v.lanes.forEach(function(t){t.stages[e].classList.remove("display-none")})}(),B.forEach(function(e,t){for(let n=0;n<2;n++){let n=Math.floor(3*Math.random()),a=D(G.Cards[132],F.players[t]);e[n].push(a),v.lanes[n].stages[t].appendChild(a.div)}if(0==F.getRound()){let r=a([0,1,2]);for(var n=0;n<3;n++){let a=F.players[t].getHeros()[n];v.lanes[r[n]].stages[t].appendChild(a.div),e[r[n]].push(a)}}F.extraDeploy[t].forEach(function(n,a){n.forEach(function(n){e[a].push(n),v.lanes[a].stages[t].appendChild(n.div)}),n.splice(0)}),F.players[t].getHeros().forEach(function(n){if(0==n.respawn&&0!=F.getRound())if(F.players[t].computer){let a=Math.floor(3*Math.random());e[a].push(n),v.lanes[a].stages[t].appendChild(n.div)}else S[t].appendChild(n.div),n.div.draggable=!0,n.updateDisplay();n.respawn-=1})}),M.classList.remove("display-none")}var W=(()=>{const e=document.getElementById("shop"),t=document.getElementById("secret-shop"),n=document.getElementById("item-deck"),r=document.getElementById("consumables"),l=document.createElement("button");l.innerHTML="Done",l.classList.add("close-btn","btn"),l.type="submit",e.appendChild(l);let s,i=["Demagicking Maul","Stonehall Plate","Stonehall Cloak"];i=i.concat(i,i);let o=["Leather Armor","Short Sword","Traveler's Cloak"],c=["Demagicking Maul","Stonehall Plate","Stonehall Cloak","Leather Armor","Short Sword","Traveler's Cloak","Blade of the Vigil","Keenfolk Musket","Red Mist Maul","Shield of Basilius","Horn of the Alpha","Phase Boots","Ring of Tarrasque"];l.addEventListener("click",function(){e.classList.add("display-none"),t.firstChild&&t.removeChild(t.firstChild),i.push(s.Name),s=null,n.firstChild&&n.removeChild(n.firstChild),r.firstChild&&r.removeChild(r.firstChild),P()});const d=(e,t=!1)=>{let r;if(t&&(e=a(e)),null!=(r=t?e.shift():e[Math.floor(Math.random()*e.length)])){let e=D(G.Cards.find(function(e){return e.Name==r}),F.players[0]);return e.div.addEventListener("click",function a(r){F.players[0].gold>=e.GoldCost&&(F.players[0].gold-=e.GoldCost,F.infoDisplayUpdate(),F.players[0].hand.push(e),F.players[0].handDiv.appendChild(e.div),t&&(s=d(i,!0))&&n.appendChild(s.div),e.div.removeEventListener("click",a))}),e}return!1};return{show:()=>{s=d(i,!0);let a=d(o),u=d(c);t.appendChild(u.div),s&&n.appendChild(s.div),r.appendChild(a.div),e.classList.remove("display-none"),l.focus()}}})();var O=()=>{const e=[],t=[document.getElementById("info-bottom"),document.getElementById("info-top")];F.players.forEach(function(n,a){t[a].classList.remove("display-none"),t[a].getElementsByClassName("name")[0].textContent=`${n.name}`,e.push(t[a].getElementsByClassName("gold")[0]),e[a].textContent=n.gold});return{updateDisplay:()=>{F.players.forEach(function(t,n){e[n].textContent=t.gold})}}};n.d(t,"game",function(){return F}),n.d(t,"cardData",function(){return G}),n.d(t,"posAvail",function(){return z});let G="not loaded yet";!function(e){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET","../node_modules/artifactdb/cards-manifest.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}(function(e){G=JSON.parse(e).Sets[0]});const V=(e,t)=>{e=[e];let n=document.createElement("div"),a=document.createElement("span");a.textContent=r(e);let l=document.createElement("div");n.appendChild(l),n.appendChild(a),l.classList.add("mana");let s=!1,i=[3,3];l.textContent=`${i[0]} : ${i[1]}`;setTimeout(function(){v.lanes[t].div.addEventListener("endOfRound",function(){o.mana[1]+=1,o.manaDiv.textContent=`${o.mana[0]} : ${o.mana[1]}`,i[0]=i[1],o.manaDiv.textContent=`${i[0]} : ${i[1]}`})},10);let o={currentHealth:e,div:n,Name:"tower",currentArmor:[0],mana:i,manaDiv:l,updateDisplay:()=>{r(o.currentHealth)<=0&&(F.score[1-t]+=1,s||(s=!s,o.currentHealth=[80],n.classList.add("ancient"))),a.textContent=r(o.currentHealth),o.manaDiv.textContent=`${o.mana[0]} : ${o.mana[1]}`}};return o},$=(e,t,n,r,l=!1)=>{let s={};return(n=n.map(function(e){return D(G.Cards.find(function(t){return t.Name==e}),s)}))[3].respawn=1,n[4].respawn=2,a(r),s.turn=e,s.handDiv=e?document.getElementById("hand-top"):document.getElementById("hand-bottom"),s.hand=[],s.draw=(()=>{let e=r.shift();if(null!=e){let t=D(G.Cards.find(function(t){return t.Name==e}),s);s.hand.push(t),s.handDiv.appendChild(t.div)}}),s.getHeros=(()=>n),s.name=t,s.computer=l,s.gold=0,s},F=(()=>{const e=document.getElementById("game");let t,n=[0,1],a=Math.random()<.5,l=0,s=0,i=[0,0];let o=new CustomEvent("afterCombat",{detail:{lane:void 0,card:void 0,player:void 0}}),c=new CustomEvent("endOfRound",{detail:{lane:void 0,card:void 0,player:void 0}}),d=new CustomEvent("continuousRefresh",{detail:{lane:void 0,card:void 0,player:void 0}}),u=new CustomEvent("continuousEffect",{detail:{lane:void 0,card:void 0,player:void 0}}),p=new CustomEvent("whenAttacking",{detail:{lane:void 0,card:void 0,player:void 0}}),m=new CustomEvent("beforeTheActionPhase",{detail:{lane:void 0,card:void 0,player:void 0}});function h(e){let t={afterCombat:e=>{if(e==s)return o},endOfRound:e=>c,beforeTheActionPhase:e=>{if(e==s)return m},continuousRefresh:e=>d,_continuousEffect:e=>u,whenAttacking:e=>{if(e==s)return p}};v.lanes.forEach(function(n,a){let r=t[e](a);null!=r&&(r.detail.lane=a,n.cards.forEach(function(e,t){r.detail.card=t,e.forEach(function(e,t){null!=e.Name&&(r.detail.player=t,e.div.dispatchEvent(r),"Hero"==e.CardType&&(e.Accessory&&(e.Accessory.div.dispatchEvent(r),e.Accessory.updateDisplay()),e.Armor&&(e.Armor.div.dispatchEvent(r),e.Armor.updateDisplay()),e.Weapon&&(e.Weapon.div.dispatchEvent(r),e.Weapon.updateDisplay())),e.updateDisplay())})}),null!=r&&n.div.dispatchEvent(r),n.improvements.forEach(function(e,t){r.detail.player=t,e.forEach(function(e,t){r.detail.card=t,e.div.dispatchEvent(r),e.updateDisplay()})}))}),"continuousRefresh"==e&&h("_continuousEffect"),"endOfRound"==e&&F.players.forEach(function(n,a){n.getHeros().forEach(function(n){let r=t[e]();r.detail.player=a,r.detail.lane=null,n.respawn>=0&&n.div.dispatchEvent(r)})})}function g(e=!1){a=1-a,e||(v.lanes[s].passCount=0),b.enable(),N.enable(),v.lanes[s].collapse(!1),v.lanes[s].expand(),n[a].computer&&f.actionPhase(n[a])}return{div:e,getCurrentLane:()=>s,startGame:()=>{console.log("Game Started"),n[0]=$(0,"Radiant",q,j),n[1]=$(1,"Dire",_,U,!0),function(){let e=["left-lane","middle-lane","right-lane"],t=["bottom","top"];v.lanes.forEach(function(n,a){n.name=e[a],n.div.classList.add("lane",e[a]),v.div.appendChild(n.div);for(var r=1;r>=0;r--)n.playAreas[r]=document.createElement("div"),n.playAreas[r].classList.add("playarea",`playarea-${t[r]}`),n.towers[r]=V(40,r),n.towers[r].div.classList.add("tower",`tower-${t[r]}`),n.div.appendChild(n.playAreas[r]),n.div.appendChild(n.towers[r].div),n.stages[r]=document.createElement("div"),n.stages[r].classList.add("stage",`stage-${t[r]}`,"display-none"),n.div.appendChild(n.stages[r]);n.playAreas[1].addEventListener("scroll",function(){n.playAreas[0].scrollLeft=n.playAreas[1].scrollLeft}),n.playAreas[0].addEventListener("scroll",function(){n.playAreas[1].scrollLeft=n.playAreas[0].scrollLeft})})}(),t=O(),v.lanes[s].div.classList.add("active"),P(),F.players.forEach(function(e){for(var t=0;t<3;t++)e.draw()}),N.initialize(),b.enable(),k.updateActive()},getRound:()=>l,score:i,gameOver:()=>!(i[0]<2&&i[1]<2||(i[0]>=2&&i[1]>=2?alert("Tie Game"):i[0]>=2?alert(`${n[0].name} Wins`):i[1]>=2&&alert(`DEFErunT : ${n[1].name} Wins`),b.hide(),0)),getTurn:()=>a,nextTurn:g,pass:()=>{v.lanes[s].passCount+=1,v.lanes[s].passCount>1?(function(){let e=v.lanes[F.getCurrentLane()];F.dispatchEvent("whenAttacking"),e.cards.forEach(function(t,n){t.forEach(function(t,a){if(null==t.Name)return;let l=e.cards[n+t.arrow][1-a];if(null==l||null==l.Name)l=e.towers[1-a];else if(r(l.retaliate)>0&&(t.currentHealth[0]-=r(l.retaliate)-r(t.currentArmor)),r(t.siege)>0&&(e.towers[1-a].currentHealth[0]-=r(t.siege)),r(t.cleave)>0)for(var s=-1;s<2;s+=2){let l=e.cards[n+t.arrow+s];null!=l&&null!=(l=e.cards[n+t.arrow+s][1-a])&&null!=l.Name&&(l.currentHealth[0]-=r(t.cleave)-r(l.currentArmor))}l.currentHealth[0]-=r(t.currentAttack)-r(l.currentArmor)}),t.forEach(function(e,t){null!=e.Name&&(r(e.regen)>0&&(e.currentHealth[0]+=r(e.regen)),e.currentHealth[0]>e.Health&&(e.currentHealth[0]=e.Health))})}),v.collapse(),e.towers[1].updateDisplay(),e.towers[0].updateDisplay(),F.dispatchEvent("afterCombat"),F.infoDisplayUpdate(),F.gameOver()}(),v.lanes[s].div.classList.remove("active"),(s+=1)>2?(b.hide(),N.hide(),W.show(),h("endOfRound"),s=0,l+=1):(g(),h("beforeTheActionPhase")),v.lanes[s].div.classList.add("active"),k.updateActive()):g(!0)},condemn:(e,t)=>{let n=t.cards.flat().indexOf(e),a=w(v.lanes.indexOf(t));e.div.classList.add("condemned"),e.div.parentNode.replaceChild(a.div,e.div),t.cards[Math.floor(n/2)][n%2]=a,e.player==F.players[0]?F.players[1].gold+=e.Bounty:F.players[0].gold+=e.Bounty,null!=e.respawn&&(e.respawn=1,e.currentHealth[0]=e.Health,e.updateDisplay())},players:n,extraDeploy:[[[],[],[]],[[],[],[]]],infoDisplayUpdate:()=>{t.updateDisplay()},dispatchEvent:h}})();function z(e,t,n){return null==t[0].Name&&e[0].push(n),null==t[1].Name&&e[1].push(n),e}const K=["Prowler Vanguard","Coup de Grace","Mystic Flare","Sow Venom","Barracks","Eclipse","Savage Wolf","Fighting Instinct","Thunderhide Pack","Emissary of the Quorum","New Orders","Ion Shell","Time of Triumph","Forward Charge","Altar of the Mad Moon","New Orders","Sister of the Veil","Rebel Decoy","Steam Cannon","Keenfolk Turret","Assassin's Apprentice","Grazing Shot","No Accident","Slay","Pick Off","Selfish Cleric","Revtel Convoy","Ravenous Mass","Rampaging Hellbear","Satyr Duelist","Savage Wolf","Satyr Magician","Disciple of Nevermore","Legion Standard Bearer","Mercenary Exiles","Verdant Refuge","Mist of Avernus","Ignite","Assault Ladders","Mana Drain","Payday","Arcane Censure","Stars Align","Bellow","Rumusque Blessing","Defensive Bloom","Restoration Effort","Intimidation","Curse of Atrophy","Strafing Run","Lightning Strike","Rolling Storm","Tower Barrage","Foresight","Prey on the Weak","Remote Detonation","Thunderstorm","Bolt of Damocles","Poised to Strike","Defensive Stance","Enrage","God's Strength","Spring the Trap","Double Edge","Conflagration","Call the Reserves","Better Late Than Never","Iron Branch Protection","Avernus' Blessing","Dimensional Portal","Bronze Legionnaire","Marrowfell Brawler","Ogre Conscript","Troll Soothsayer","Untested Grunt","Thunderhide Alpha"];let j,U=["Prowler Vanguard","Coup de Grace","Mystic Flare","Sow Venom","Barracks","Thunderhide Pack","Altar of the Mad Moon","Time of Triumph","Forward Charge","Ion Shell","Sister of the Veil","Rebel Decoy","Assassin's Apprentice","Grazing Shot","No Accident","Slay","Pick Off","Selfish Cleric","Revtel Convoy","Ravenous Mass","Rampaging Hellbear","Satyr Duelist","Savage Wolf","Satyr Magician","Disciple of Nevermore","Legion Standard Bearer","Mercenary Exiles","Verdant Refuge","Mist of Avernus","Ignite","Assault Ladders","Mana Drain","Arcane Censure","Stars Align","Bellow","Rumusque Blessing","Defensive Bloom","Restoration Effort","Intimidation","Curse of Atrophy","Strafing Run","Lightning Strike","Rolling Storm","Tower Barrage","Foresight","Prey on the Weak","Remote Detonation","Thunderstorm","Bolt of Damocles","Poised to Strike","Defensive Stance","Enrage","God's Strength","Spring the Trap","Double Edge","Conflagration","Call the Reserves","Better Late Than Never","Iron Branch Protection","Avernus' Blessing","Dimensional Portal","Bronze Legionnaire","Marrowfell Brawler","Ogre Conscript","Troll Soothsayer","Untested Grunt","Thunderhide Alpha"],_=["J'Muy the Wise","Legion Commander","Lycan","Centaur Warrunner","Drow Ranger","Sorla Khan","Phantom Assassin","Bounty Hunter","Venomancer","Prellex","Sven","Luna","Treant Protector","Enchantress","Debbi the Cunning","Keefe the Bold","Fahrvhan the Dreamer","Axe"];_=a(_).slice(0,5);let q,J=["Legion Commander","Lycan","Winter Wyvern","Skywrath Mage","Centaur Warrunner","Omniknight","Drow Ranger","Sorla Khan","Phantom Assassin","Lion","Lich","Bounty Hunter","Venomancer","Prellex","Pugna","Sven","Luna","Treant Protector","Enchantress","Debbi the Cunning","Keefe the Bold","Fahrvhan the Dreamer","J'Muy the Wise","Axe"];const Q=document.getElementById("start-game-btn"),X=document.getElementById("deck-textarea"),Y=document.getElementById("heroes-textarea"),Z=document.getElementById("deck-game-btn"),ee=document.getElementById("heroes-game-btn"),te=document.getElementById("start-screen"),ne=document.getElementById("deck-options"),ae=document.getElementById("heroes-options"),re=document.getElementById("deck-reset-btn"),le=document.getElementById("deck-3of"),se=document.getElementById("heroes-reset-btn");Z.title="If card is not vaild or implemented it will be ignored",ee.title="Uses the 1st 5 heroes",X.value=localStorage.getItem("deck"),X.value=X.value||K,X.placeholder="  If empty all cards will be added to your deck.",le.checked=null==localStorage.getItem("3of")||"true"==localStorage.getItem("3of"),Y.value=localStorage.getItem("heroes"),Y.value=Y.value||J,X.title="adds 3 of each listed card",Y.placeholder="  If empty your heroes will be Legion Commander, Lycan, Winter Wyvern, Skywrath Mage, Centaur Warrunner",Q.disabled=!0;setTimeout(function(){Q.disabled=!1},500),Q.addEventListener("click",function(){U=U.filter(function(e){let t=G.Cards.find(function(t){return t.Name==e}).Color;return _.map(function(e){return G.Cards.find(function(t){return t.Name==e}).Color}).includes(t)}),(j=(j=(j=X.value.split(",")).map(function(e){return e.trim()})).filter(function(e){return K.includes(e)})).length||(j=K),(q=(q=(q=Y.value.split(",")).map(function(e){return e.trim()})).filter(function(e){return J.includes(e)})).length<5&&(q=J),localStorage.setItem("heroes",q),q.length>5&&(q=q.slice(0,5)),localStorage.setItem("deck",j),localStorage.setItem("3of",le.checked),le.checked&&(j=j.concat(j,j)),U=U.concat(U,U),te.parentNode.removeChild(te),F.startGame()}),Z.addEventListener("click",function(){X.classList.toggle("display-none"),Y.classList.add("display-none"),ne.classList.toggle("display-none"),ae.classList.add("display-none")}),ee.addEventListener("click",function(){Y.classList.toggle("display-none"),X.classList.add("display-none"),ae.classList.toggle("display-none"),ne.classList.add("display-none")}),re.addEventListener("click",function(){X.value=K}),se.addEventListener("click",function(){Y.value=J})}]);