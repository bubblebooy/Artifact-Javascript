!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e){for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}function r(e){return"number"==typeof e?e:e.reduce((e,t)=>e+t)}a.r(t);const l=document.getElementById("last-played-top");let s=document.createElement("div");function i(e,t,a){return null!=t[0].Name&&e[0].push(a),null!=t[1].Name&&e[1].push(a),e}function o(e,t,a){return null!=t[0].Name&&"Hero"==t[0].CardType&&e[0].push(a),null!=t[1].Name&&"Hero"==t[0].CardType&&e[1].push(a),e}function d(e,t,a){return null!=t[0].Name&&"Creep"==t[0].CardType&&e[0].push(a),null!=t[1].Name&&"Creep"==t[1].CardType&&e[1].push(a),e}l.appendChild(s);let c=["Viscous Nasal Goo","Winter's Curse","Act of Defiance","Frostbite","Coup de Grace","Mystic Flare","Intimidation","Bellow","Relentless Pursuit","Viscous Nasal Goo","Crippling Blow","Rend Armor","Grazing Shot","No Accident","Slay","Pick Off","Assassinate"];c=new Map(c.map(e=>[e,!0]));let u=["Slay","Bellow"];u=new Map(u.map(e=>[e,!0]));const f={actionPhase:e=>{let t;n(e.hand);e:for(var a=0;a<e.hand.length;a++)if(((t=e.hand[a]).ManaCost||0)<=y.lanes[$.getCurrentLane()].towers[e.turn].mana[0]&&(t.div.ondragstart(new DragEvent({setData:null})),y.lanes[$.getCurrentLane()].cards.some(L)||"Item"==v.CardType)){if("Creep"==v.CardType){let t=y.lanes[$.getCurrentLane()].cards.reduce(U,[[],[]])[e.turn],a={preventDefault:()=>{},target:(t=y.lanes[$.getCurrentLane()].cards[t[Math.floor(Math.random()*t.length)]][e.turn]).div,currentTarget:t.div};t.drop(a);break e}if("Improvement"==v.CardType){let e=y.lanes[Math.floor(3*Math.random())],t={preventDefault:()=>{},target:e.div,currentTarget:e.div};e.drop(t);break e}if("Spell"==v.CardType||"Item"==v.CardType){let a,n=m.get(v.Name);if("Item"==v.CardType&&"Consumable"!=v.ItemType&&(n="unit"),a=v.CrossLane?y.lanes[Math.floor(3*Math.random())]:y.lanes[$.getCurrentLane()],"lane"==n)n=a;else if("unit"==n){let r=c.get(t.Name)?1-e.turn:e.turn;if((n=u.get(t.Name)?a.cards.reduce(d,[[],[]])[r]:a.cards.reduce(o,[[],[]])[r]).length<=0)break e;if(n=a.cards[n[Math.floor(Math.random()*n.length)]][r],"Item"==v.CardType)if("Armor"==v.ItemType){if(n.Armor)break e}else if("Accessory"==v.ItemType){if(n.Accessory)break e}else if("Weapon"==v.ItemType&&n.Weapon)break e}let r={preventDefault:()=>{},target:n.div,currentTarget:n.div};n.drop(r);break e}break e}$.getTurn()!=e.turn&&(t=t.div.cloneNode(!0),s.parentNode.replaceChild(t,s),s=t),setTimeout(function(){$.getTurn()==e.turn&&$.pass()},300)},shop:e=>{for(var t=0;t<2;t++){let t=Y,a=t[Math.floor(Math.random()*t.length)];a=w(F.Cards.find(function(e){return e.Name==a}),$.players[e]),console.log(a),$.players[e].gold>=a.GoldCost&&($.players[e].gold-=a.GoldCost,$.players[e].hand.push(a),$.players[e].handDiv.appendChild(a.div))}$.infoDisplayUpdate()}};let p=new Map,m=new Map;function h(e,t,a,n=(()=>!0)){e.div.classList.add("glow"),$.div.classList.add("target"),$.div.addEventListener("click",function r(l){l.stopPropagation();let s=l.path||l.composedPath&&l.composedPath();s||console.log("no path");e:{if(e!=v)break e;let r,l=s.find(function(e){if(e.classList)return e.classList.contains("lane")});if(void 0!=l){if(l=y.lanes.find(function(e){return e.div==l}),"card"==t||"empty"==t){if(void 0==(r=s.find(function(e){if(e.classList)return e.classList.contains("playarea")})))break e;r=l.playAreas.findIndex(function(e){return e==r})}else if("tower"==t){if(void 0==(r=s.find(function(e){if(e.classList)return e.classList.contains("tower")})))break e;r=l.towers.findIndex(function(e){return e.div==r})}if("card"==t){if(void 0==(t=s.find(function(e){if(e.classList)return e.classList.contains("card")})))break e;t=l.cards.findIndex(function(e){return e[r].div==t})}else if("empty"==t){if(void 0==(t=s.find(function(e){if(e.classList)return e.classList.contains("blank")})))break e;t=l.cards.findIndex(function(e){return e[r].div==t})}else"tower"==t&&(t=r);n(l,r,t)&&(a(l,r,t),y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]-=e.ManaCost,y.lanes[$.getCurrentLane()].towers[$.getTurn()].updateDisplay(),$.players[$.getTurn()].hand.splice($.players[$.getTurn()].hand.indexOf(v),1),v.div.parentNode.removeChild(v.div),$.nextTurn())}}e.div.classList.remove("glow"),$.div.classList.remove("target"),$.div.removeEventListener("click",r,!0)},!0)}m.set("Dimensional Portal","lane"),p.set("Dimensional Portal",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<3;e++){let e=w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Better Late Than Never","lane"),p.set("Better Late Than Never",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<1;e++){let e=w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Call the Reserves","lane"),p.set("Call the Reserves",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<2;e++){let e=w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Iron Branch Protection","unit"),p.set("Iron Branch Protection",function(e,t,a,n){return y.lanes[t].cards[n][a].currentArmor[5]+=3,y.lanes[t].cards[n][a].updateDisplay(),!0}),m.set("Avernus' Blessing","unit"),p.set("Avernus' Blessing",function(e,t,a,n){return y.lanes[t].cards[n][a].currentAttack[1+(1-a==$.getTurn())]+=2,y.lanes[t].cards[n][a].updateDisplay(),!0}),m.set("Double Edge","unit"),p.set("Double Edge",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentArmor[3]-=8,y.lanes[t].cards[n][a].currentAttack[3]+=8,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Poised to Strike","unit"),p.set("Poised to Strike",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentAttack[3]+=4,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Defensive Stance","unit"),p.set("Defensive Stance",function(e,t,a,n){return"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentArmor[5]+=3,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Combat Training","unit"),p.set("Combat Training",function(e,t,a,n){return"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentAttack[1+(1-a==$.getTurn())]+=2,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Collateral Damage","unit"),p.set("Collateral Damage",function(e,t,a,n){return"Hero"==y.lanes[t].cards[n][a].CardType&&"Black"==y.lanes[t].cards[n][a].Color&&(y.lanes[t].cards[n][a].siege[1+(1-a==$.getTurn())]+=3,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Enrage","unit"),p.set("Enrage",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentArmor[3]+=4,y.lanes[t].cards[n][a].currentAttack[3]+=4,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("God's Strength","unit"),p.set("God's Strength",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentAttack[1+(1-a==$.getTurn())]+=4,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Spring the Trap","lane"),p.set("Spring the Trap",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<2;e++){let e=w(F.Cards.find(function(e){return"Centaur Hunter"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Strafing Run","lane"),p.set("Strafing Run",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&"Creep"==e[1-n].CardType&&(e[1-n].currentHealth[0]-=2-r(e[1-n].currentArmor))}),a.collapse(),!0}),m.set("Lightning Strike","lane"),p.set("Lightning Strike",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[1-n].currentHealth[0]-=6-r(a.towers[1-n].currentArmor),a.towers[1-n].updateDisplay(),!0}),m.set("Rolling Storm","lane"),p.set("Rolling Storm",function(e,t){let a=$.getTurn();return y.lanes.forEach(function(e){e.towers[a].currentHealth[0]-=2-r(e.towers[a].currentArmor),e.towers[a].updateDisplay(),e.towers[1-a].currentHealth[0]-=2-r(e.towers[1-a].currentArmor),e.towers[1-a].updateDisplay()}),!0}),m.set("Tower Barrage","lane"),p.set("Tower Barrage",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&(e[1-n].currentHealth[0]-=2-r(e[1-n].currentArmor))}),a.collapse(),!0}),m.set("Foresight","lane"),p.set("Foresight",function(e,t){let a=$.players[$.getTurn()];return a.draw(),a.draw(),!0}),m.set("Prey on the Weak","lane"),p.set("Prey on the Weak",function(e,t){let a=y.lanes[t],n=[[],[]],r=$.getTurn();return a.cards.forEach(function(e){if(null!=e[1-r].Name&&e[1-r].currentHealth[0]<e[1-r].Health){let e=w(F.Cards.find(function(e){return"Hound of War"==e.Name}),$.players[$.getTurn()]);n[$.getTurn()].push(e)}if(null!=e[r].Name&&e[r].currentHealth[0]<e[r].Health){let e=w(F.Cards.find(function(e){return"Hound of War"==e.Name}),$.players[$.getTurn()]);n[$.getTurn()].push(e)}}),a.summon(n),!0}),m.set("Remote Detonation","lane"),p.set("Remote Detonation",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&null==e[n].Name&&(e[1-n].currentHealth[0]-=5-r(e[1-n].currentArmor))}),a.collapse(),!0}),m.set("Thunderstorm","lane"),p.set("Thunderstorm",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&(e[1-n].currentHealth[0]-=4-r(e[1-n].currentArmor))}),a.collapse(),!0}),m.set("Bolt of Damocles","lane"),p.set("Bolt of Damocles",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[1-n].currentHealth[0]-=20-r(a.towers[1-n].currentArmor),a.towers[1-n].updateDisplay(),!0}),m.set("Stars Align","lane"),p.set("Stars Align",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[n].mana[0]+=3,a.towers[n].updateDisplay(),!0}),m.set("Bellow","unit"),p.set("Bellow",function(e,t,a,n){let r=[[],[]];if("Creep"!=y.lanes[t].cards[n][a].CardType)return!1;let l=y.lanes[t].cards[n][a],s=D(t);return y.lanes[t].cards[n][a]=s,l.div.parentNode.replaceChild(s.div,l.div),r[a].push(l),y.lanes[(t+Math.ceil(2*Math.random()))%3].summon(r),!0}),m.set("Rumusque Blessing","lane"),p.set("Rumusque Blessing",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[n].Name&&(e[n].currentHealth[1]+=3,e[n].updateDisplay())}),!0}),m.set("Defensive Bloom","lane"),p.set("Defensive Bloom",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<2;e++){let e=w(F.Cards.find(function(e){return"Roseleaf Wall"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Restoration Effort","lane"),p.set("Restoration Effort",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[n].currentHealth[0]+=8,a.towers[n].currentHealth[0]>40&&(a.towers[n].currentHealth[0]=40),a.towers[n].updateDisplay(),!0}),m.set("Intimidation","unit"),p.set("Intimidation",function(e,t,a,n){let r=[[],[]],l=y.lanes[t].cards[n][a],s=D(t);return y.lanes[t].cards[n][a]=s,l.div.parentNode.replaceChild(s.div,l.div),r[a].push(l),y.lanes[(t+Math.ceil(2*Math.random()))%3].summon(r),!0}),m.set("Curse of Atrophy","lane"),p.set("Curse of Atrophy",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&"Hero"==e[1-n].CardType&&(e[1-n].currentAttack[2]-=2,e[1-n].updateDisplay())}),!0}),m.set("Grazing Shot","unit"),p.set("Grazing Shot",function(e,t,a,n){let l=y.lanes[t];return l.cards[n][a].currentHealth[0]-=2-r(l.cards[n][a].currentArmor),l.collapse(),!0}),m.set("Mana Drain","lane"),p.set("Mana Drain",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[n].mana[0]+=2,a.towers[n].updateDisplay(),a.towers[1-n].mana[0]-=2,a.towers[1-n].updateDisplay(),!0}),m.set("No Accident","unit"),p.set("No Accident",function(e,t,a,n){let l=y.lanes[t];return l.cards[n][a].currentHealth[0]-=3-r(l.cards[n][a].currentArmor),l.collapse(),!0}),m.set("Payday","lane"),p.set("Payday",function(e,t){return $.players[$.getTurn()].gold*=2,$.infoDisplayUpdate(),!0}),m.set("Slay","unit"),p.set("Slay",function(e,t,a,n){let r=y.lanes[t];return"Creep"==r.cards[n][a].CardType&&($.condemn(r.cards[n][a],y.lanes[t]),$.infoDisplayUpdate(),r.collapse(),!0)}),m.set("Arcane Censure","lane"),p.set("Arcane Censure",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.towers[1-n].mana[1]-=1,a.towers[1-n].mana[0]-=1,a.towers[1-n].updateDisplay(),!0}),m.set("Pick Off","unit"),p.set("Pick Off",function(e,t,a,n){let l=y.lanes[t];return l.cards[n][a].currentHealth[0]-=4-r(l.cards[n][a].currentArmor),l.collapse(),!0}),m.set("Assassinate","unit"),p.set("Assassinate",function(e,t,a,n){let l=y.lanes[t];return l.cards[n][a].currentHealth[0]-=10-(r(l.cards[n][a].currentArmor)<0?r(l.cards[n][a].currentArmor):0),l.collapse(),!0}),m.set("New Orders","unit"),p.set("New Orders",function(e,t,a,n){let r=y.lanes[t],l=r.cards[n][a];return a==$.getTurn()&&(h(v,"card",function(e,t,a){l.arrow=a-n,l.updateDisplay()},function(e,t,l){return e==r&&$.players[a]!=t&&Math.abs(l-n)<=1}),!1)}),m.set("Battlefield Control","unit"),p.set("Battlefield Control",function(e,t,a,n){let r=y.lanes[t],l=r.cards[n][a];return h(v,"card",function(e,t,a){l.arrow=a-n,l.updateDisplay()},function(e,t,l){return e==r&&$.players[a]!=t&&Math.abs(l-n)<=1}),!1}),m.set("Murder Plot","unit"),p.set("Murder Plot",function(e,t,a,n){let r=y.lanes[t],l=r.cards[n][a];return"Hero"==y.lanes[t].cards[n][a].CardType&&"Black"==y.lanes[t].cards[n][a].Color&&(h(v,"card",function(e,t,a){l.arrow=a-n,l.currentAttack[3]+=8,l.updateDisplay()},function(e,t,l){return e==r&&$.players[a]!=t&&Math.abs(l-n)<=1}),!1)}),m.set("Steal Strength","unit"),p.set("Steal Strength",function(e,t,a,n){let r=y.lanes[t],l=r.cards[n][a];return h(v,"card",function(e,t,a){l.currentAttack[3]-=4,l.updateDisplay();let n=e.cards[a][t];n.currentAttack[3]+=4,n.updateDisplay()},function(e,t,a){return e==r}),!1}),m.set("Ion Shell","unit"),p.set("Ion Shell",function(e,t,a,n){return y.lanes[t].cards[n][a].retaliate[1+(1-a==$.getTurn())]+=3,y.lanes[t].cards[n][a].updateDisplay(),!0}),m.set("Forward Charge","lane"),p.set("Forward Charge",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[n].Name&&(e[n].siege[3]+=2,e.arrow=0,e[n].updateDisplay())}),!0}),m.set("Time of Triumph","lane"),p.set("Time of Triumph",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[n].Name&&"Hero"==e[n].CardType&&(e[n].currentAttack[1]+=4,e[n].currentArmor[1]+=4,e[n].currentHealth[1]+=4,e[n].cleave[1]+=4,e[n].retaliate[1]+=4,e[n].siege[1]+=4,e[n].updateDisplay())}),!0}),m.set("Fighting Instinct","unit"),p.set("Fighting Instinct",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&(y.lanes[t].cards[n][a].currentArmor[1]+=1,y.lanes[t].cards[n][a].currentAttack[1]+=1,y.lanes[t].cards[n][a].updateDisplay(),!0)}),m.set("Eclipse","lane"),p.set("Eclipse",function(e,t,a,n){let l=y.lanes[t],s=$.getTurn(),o=$.players[$.getTurn()].getHeros().find(function(e){return"Luna"==e.Name}).beams;if(o)for(var d=0;d<o;d++){let e=l.cards.reduce(i,[[],[]])[1-s];0!=e.length&&(e=e[Math.floor(Math.random()*e.length)],null!=(e=l.cards[e])[1-s].Name&&(e[1-s].currentHealth[0]-=3-(r(e[1-s].currentArmor)<0?r(e[1-s].currentArmor):0),l.collapse()))}return!0}),m.set("Sow Venom","lane"),p.set("Sow Venom",function(e,t){let a=[[],[]];t=y.lanes[t];for(let e=0;e<2;e++){let e=w(F.Cards.find(function(e){return"Plague Ward"==e.Name}),$.players[$.getTurn()]);a[$.getTurn()].push(e)}return t.summon(a),!0}),m.set("Mystic Flare","unit"),p.set("Mystic Flare",function(e,t,a,n){let l=y.lanes[t];for(var s=0;s<12;)for(var i=-1;i<=1;i++)null!=l.cards[n+i]&&null!=l.cards[n+i][a].Name&&(l.cards[n+i][a].currentHealth[0]-=2,s+=2);for(i=-1;i<=1;i++)null!=l.cards[n+i]&&null!=l.cards[n+i][a].Name&&(l.cards[n+i][a].currentHealth[0]+=r(l.cards[n+i][a].currentArmor),l.cards[n+i][a].updateDisplay());return l.collapse(),!0}),m.set("Coup de Grace","unit"),p.set("Coup de Grace",function(e,t,a,n){let r=y.lanes[t];if("Hero"!=r.cards[n][a].CardType)return!1;$.condemn(r.cards[n][a],y.lanes[t]),$.infoDisplayUpdate(),r.collapse();let l=$.players[$.getTurn()].hand;if(l.length>1){let e=Math.floor(Math.random()*l.length);l[e]==v&&(e=(e+1)%l.length),(e=l.splice(e,1)[0]).div.parentNode.removeChild(e.div)}return!0}),m.set("Berserker's Call","unit"),p.set("Berserker's Call",function(e,t,a,n){if("Red"!=y.lanes[t].cards[n][a].Color||"Hero"!=y.lanes[t].cards[n][a].CardType||a!==$.getTurn())return!1;$.dispatchEvent("whenAttacking");const r=y.lanes[t];for(var l=-1;l<=1;l++)null!=r.cards[n+l]&&null!=r.cards[n+l][1-a].Name&&z(t,a,n,t,1-a,n+l,!1);return r.collapse(),!0}),m.set("Duel","unit"),p.set("Duel",function(e,t,a,n){return"Red"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&a===$.getTurn()&&(h(v,"card",function(e,r,l){z(t,a,n,y.lanes.indexOf(e),r,l,!1),y.lanes[t].collapse()},function(e,a,n){return e==y.lanes[t]}),!1)}),m.set("Gank","unit"),p.set("Gank",function(e,t,a,n){return t==$.getCurrentLane()&&"Black"==y.lanes[t].cards[n][a].Color&&"Hero"==y.lanes[t].cards[n][a].CardType&&a===$.getTurn()&&(h(v,"card",function(e,r,l){z(t,a,n,y.lanes.indexOf(e),r,l,!1),y.lanes[t].collapse(),e.collapse(),$.infoDisplayUpdate()},function(e,t,a){return!0}),!1)}),m.set("Frostbite","unit"),p.set("Frostbite",function(e,t,a,n){let l=y.lanes[t];return l.cards[n][a].currentHealth[0]-=2-r(l.cards[n][a].currentArmor),l.cards[n][a].disarmed=!0,l.collapse(),!0}),m.set("Act of Defiance","unit"),p.set("Act of Defiance",function(e,t,a,n){return y.lanes[t].cards[n][a].silenced=!0,!0}),m.set("Gust","lane"),p.set("Gust",function(e,t){let a=y.lanes[t],n=$.getTurn();return a.cards.forEach(function(e){null!=e[1-n].Name&&"Hero"==e[1-n].CardType&&(e[1-n].silenced=!0)}),!0}),m.set("Winter's Curse","unit"),p.set("Winter's Curse",function(e,t,a,n){y.lanes[t].cards[n][a].disarmed=!0,$.dispatchEvent("whenAttacking");const r=y.lanes[t];for(var l=-1;l<=1;l+=2)null!=r.cards[n+l]&&null!=r.cards[n+l][a].Name&&z(t,a,n,t,a,n+l,!1);return r.collapse(),!0}),m.set("Echo Slam","lane"),p.set("Echo Slam",function(e,t,a,n){let l=y.lanes[t],s=$.getTurn(),o=l.cards.reduce(i,[[],[]])[1-s];return 0!=o.length&&o.forEach(function(e){null!=(e=l.cards[e])[1-s].Name&&(e[1-s].currentHealth[0]-=o.length-r(e[1-s].currentArmor))}),l.collapse(),!0}),m.set("Healing Salve","unit"),p.set("Healing Salve",function(e,t,a,n){let r=y.lanes[t];return r.cards[n][a].currentHealth[0]+=6,r.cards[n][a].currentHealth[0]>r.cards[n][a].Health&&(r.cards[n][a].currentHealth[0]=r.cards[n][a].Health),r.cards[n][a].updateDisplay(),!0}),m.set("Fountain Flask","unit"),p.set("Fountain Flask",function(e,t,a,n){let r=y.lanes[t];return r.cards[n][a].currentHealth[0]=r.cards[n][a].Health,r.cards[n][a].updateDisplay(),!0}),m.set("Potion of Knowledge","lane"),p.set("Potion of Knowledge",function(e,t,a,n){return $.players[$.getTurn()].draw(),!0}),m.set("Town Portal Scroll","unit"),p.set("Town Portal Scroll",function(e,t,a,n){if("Hero"!=y.lanes[t].cards[n][a].CardType||a!=$.getTurn())return!1;let r=y.lanes[t].cards[n][a],l=D(t);return r.div.parentNode.replaceChild(l.div,r.div),y.lanes[t].cards[n][a]=l,r.respawn=0,r.currentHealth[0]=r.Health,r.updateDisplay(),!0}),m.set("Pick a Fight","unit"),p.set("Pick a Fight",function(e,t,a,n){let r=y.lanes[t],l=r.cards[n][a];return"Hero"==r.cards[n][a].CardType&&a==$.getTurn()&&(h(v,"card",function(e,t,s){l.arrow=s-n;for(var i=-1;i<=1;i++)null!=r.cards[n+i]&&null!=r.cards[n+i][1-a].Name&&(r.cards[n+i][1-a].arrow=-1*i,r.cards[n+i][1-a].updateDisplay());l.updateDisplay()},function(e,t,l){return e==r&&$.players[a]!=t&&Math.abs(l-n)<=1}),!1)}),m.set("Viscous Nasal Goo","unit"),p.set("Viscous Nasal Goo",function(e,t,a,n){return y.lanes[t].cards[n][a].currentArmor[2]-=2,y.lanes[t].cards[n][a].updateDisplay(),!0});const g=e=>{let t=document.createElement("div"),a=[void 0,void 0],n=[void 0,void 0],l=[],s=[[],[]],i=[document.createElement("div"),document.createElement("div")];i.forEach(function(e,a){e.classList.add("improvement",a?"top":"bottom"),t.appendChild(e)}),t.ondragover=function(e){e.preventDefault()},t.addEventListener("dragenter",function(e){e.target.classList.add("dragover")}),t.addEventListener("dragleave",function(e){e.target.classList.remove("dragover")}),t.ondrop=(e=>o(e));const o=t=>{t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]<v.ManaCost||e!=$.getCurrentLane()&&!v.CrossLane||"lane"!=m.get(v.Name)&&"Improvement"!=v.CardType||(y.lanes[$.getCurrentLane()].cards.some(L)||"Item"==v.CardType)&&("Improvement"==v.CardType?(v.div.draggable=!1,s[$.getTurn()].push(v),i[$.getTurn()].appendChild(v.div)):(p.get(v.Name)(t,e),v.div.parentNode.removeChild(v.div)),y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]-=v.ManaCost,y.lanes[$.getCurrentLane()].towers[$.getTurn()].updateDisplay(),$.players[$.getTurn()].hand.splice($.players[$.getTurn()].hand.indexOf(v),1),d(),c(),$.dispatchEvent("continuousRefresh"),$.nextTurn())},d=(t=!0)=>{l.flat().forEach(function(t){null!=t.currentHealth&&r(t.currentHealth)<=0&&$.condemn(t,y.lanes[e])});let a=!1;l.forEach(function(e,t){e.forEach(function(e,a){null!=e.Name&&null==l[t+e.arrow][1-a].Name&&(e.arrow=0)})}),l.forEach(function(e,t){null==e[0].Name&&null==e[1].Name&&(a=!0,e[0].div.parentNode.removeChild(e[0].div),e[1].div.parentNode.removeChild(e[1].div),l.splice(t,1))}),a?d(t):t&&$.dispatchEvent("continuousRefresh")},c=()=>{if(0==l.reduce(U,[[],[]])[$.getTurn()].length){let t=[D(e,n[0],l.length),D(e,n[1],l.length)],a=[D(e,n[0],0),D(e,n[1],0)];l.push(t),l.unshift(a)}};return{name:name,div:t,cards:l,towers:a,improvements:s,playAreas:n,stages:[],passCount:0,collapse:d,expand:c,summon:(t,a=!0)=>{t.forEach(function(t,a){for(;l.reduce(U,[[],[]])[a].length<t.length;){let t=Math.random()<.5;t=t?n[0].childNodes.length:0;let a=[D(e,n[0],t),D(e,n[1],t)];t?l.push(a):l.unshift(a)}}),t.forEach(function(t,n){t.forEach(function(t){let r=l.reduce(U,[[],[]])[n];r=r[Math.floor(Math.random()*r.length)];let s=l[r][n].div;s.parentNode.replaceChild(t.div,s),l[r][n]=t,t.arrow=0,null!=l[r][1-n].Name&&(l[r][1-n].arrow=0),a&&(t.rndArrow(e,r,n),$.dispatchEvent("continuousRefresh"))})})},drop:o}},y={div:document.getElementById("board"),lanes:[g(0),g(1),g(2)],collapse:()=>{y.lanes.forEach(function(e){e.collapse(!1)}),$.dispatchEvent("continuousRefresh")}};let v,C=new Map,E=new Map;function A(e,t,a,n,r=!0){let l=e.Abilities.findIndex(function(e){return e.div==t});e.Abilities[l].div.classList.add("glow"),$.div.classList.add("target"),$.div.addEventListener("click",function t(s){s.stopPropagation();let i=s.path||s.composedPath&&s.composedPath();i||console.log("no path");e:{let t,s=i.find(function(e){if(e.classList)return e.classList.contains("lane")});if(void 0!=s){if(s=y.lanes.find(function(e){return e.div==s}),"card"==a||"empty"==a){if(void 0==(t=i.find(function(e){if(e.classList)return e.classList.contains("playarea")})))break e;t=s.playAreas.findIndex(function(e){return e==t})}else if("tower"==a){if(void 0==(t=i.find(function(e){if(e.classList)return e.classList.contains("tower")})))break e;t=s.towers.findIndex(function(e){return e.div==t})}if("card"==a){if(void 0==(a=i.find(function(e){if(e.classList)return e.classList.contains("card")})))break e;a=s.cards.findIndex(function(e){return e[t].div==a})}else if("empty"==a){if(void 0==(a=i.find(function(e){if(e.classList)return e.classList.contains("blank")})))break e;a=s.cards.findIndex(function(e){return e[t].div==a})}else"tower"==a&&(a=t);r(s,t,a)&&(n(s,t,a),e.Abilities[l].currentCooldown=e.Abilities[l].Cooldown,e.updateDisplay(),$.nextTurn())}}$.div.classList.remove("target"),e.Abilities[l].div.classList.remove("glow"),$.div.removeEventListener("click",t,!0)},!0)}function T(e,t){return e=function(){let a=e;return function(){t(),a.apply(this)}}()}C.set("testAbility",function(){console.log("testAbility")}),E.set("Pack Leadership","continuousEffect"),C.set("Pack Leadership",function(e,t){for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentArmor[4]+=1,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Wisdom of the Elders","click"),C.set("Wisdom of the Elders",function(e,t){return e.player.draw(),!0}),E.set("Work the Knife","whenAttacking"),C.set("Work the Knife",function(e,t){let a=y.lanes[t.detail.lane],n=t.detail.card+e.arrow;null!=a.cards[n]&&null!=a.cards[n][1-t.detail.player].Name&&"Creep"==a.cards[n][1-t.detail.player].CardType||(e.currentAttack[4]+=2)}),E.set("Call of the Wild","click"),C.set("Call of the Wild",function(e,t){let a=[[],[]],n=y.lanes[$.getCurrentLane()],r=w(F.Cards.find(function(e){return"Loyal Beast"==e.Name}),$.players[$.getTurn()]);return a[$.getTurn()].push(r),n.summon(a),!0}),E.set("Return","continuousEffect"),C.set("Return",function(e,t){e.retaliate[4]+=2}),E.set("Moment of Courage","continuousEffect"),C.set("Moment of Courage",function(e,t){e.retaliate[4]+=2}),E.set("Concussive Shot","click"),C.set("Concussive Shot",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentArmor[3]-=2,e.cards[a][t].updateDisplay(),null!=e.cards[a-1]&&null!=e.cards[a-1][t].Name&&(e.cards[a-1][t].currentArmor[3]-=2,e.cards[a-1][t].updateDisplay()),null!=e.cards[a+1]&&null!=e.cards[a+1][t].Name&&(e.cards[a+1][t].currentArmor[3]-=2,e.cards[a+1][t].updateDisplay())},function(e,t,a){return e==y.lanes[$.getCurrentLane()]&&"Hero"==e.cards[a][t].CardType}),!1}),E.set("Nature's Attendants","continuousEffect"),C.set("Nature's Attendants",function(e,t){e.regen[4]+=2,e.updateDisplay();for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].regen[4]+=2,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Branches of Iron","continuousEffect"),C.set("Branches of Iron",function(e,t){for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentArmor[4]+=2,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Feral Impulse","continuousEffect"),C.set("Feral Impulse",function(e,t){for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentAttack[4]+=2,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Arctic Burn","afterCardPlayed"),C.set("Arctic Burn",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n]==e});return A(e,t.currentTarget,"empty",function(t,l,s){e.currentAttack[3]+=4;let i=r>s?e.div.nextSibling:t.cards[s][l].div.nextSibling;r>s?t.cards[s][l].div.parentNode.insertBefore(e.div,t.cards[s][l].div):e.div.parentNode.insertBefore(t.cards[s][l].div,e.div),r>s?e.div.parentNode.insertBefore(t.cards[s][l].div,i):t.cards[s][l].div.parentNode.insertBefore(e.div,i);let o=t.cards[s][l];t.cards[s][l]=a.cards[r][n],a.cards[r][n]=o,null!=t.cards[s][1-l].Name&&(t.cards[s][1-l].arrow=0,e.arrow=0,t.cards[s][1-l].updateDisplay()),e.updateDisplay(),a.collapse()},function(e,t,r){return e==a&&n==t}),!1}),E.set("Nether Blast","click"),C.set("Nether Blast",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn();a.cards.findIndex(function(t){return t[n]==e});if(a.improvements[1-n].length){let e=Math.floor(Math.random()*a.improvements[1-n].length);return(e=a.improvements[1-n].splice(e)[0]).div.parentNode.removeChild(e.div),!0}return!1}),E.set("Great Cleave","continuousEffect"),C.set("Great Cleave",function(e,t){e.cleave[4]+=Math.floor(r(e.currentAttack)/2)}),E.set("Lucent Beam","beforeTheActionPhase"),C.set("Lucent Beam",function(e,t){let a=y.lanes[t.detail.lane],n=a.cards.reduce(i,[[],[]])[1-t.detail.player];0!=n.length&&(n=n[Math.floor(Math.random()*n.length)],null!=(n=a.cards[n])[1-t.detail.player].Name&&(e.beams=e.beams||0,e.beams+=1,n[1-t.detail.player].currentHealth[0]-=1-(r(n[1-t.detail.player].currentArmor)<0?r(n[1-t.detail.player].currentArmor):0),a.collapse()))}),E.set("Bringer of the Faithful","endOfRound"),C.set("Bringer of the Faithful",function(e,t){null!=t.detail.lane&&$.extraDeploy[t.detail.player][t.detail.lane].push(w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[t.detail.player]))}),E.set("Venomous Nature","endOfRound"),C.set("Venomous Nature",function(e,t){null!=t.detail.lane&&$.extraDeploy[t.detail.player][t.detail.lane].push(w(F.Cards.find(function(e){return"Plague Ward"==e.Name}),$.players[t.detail.player]))}),E.set("Jinada","beforeTheActionPhase"),C.set("Jinada",function(e,t){Math.random()<.5&&(e.currentAttack[3]+=4,e.updateDisplay())}),E.set("Sacrifice","click"),C.set("Sacrifice",function(e,t){return A(e,t.currentTarget,"card",function(t,a,n){e.player.draw(),r(t.cards[n][a].currentAttack)>=6&&e.player.draw(),$.condemn(t.cards[n][a],t),$.infoDisplayUpdate(),t.collapse()},function(t,a,n){return t==y.lanes[$.getCurrentLane()]&&$.getTurn()==a&&t.cards[n][a]!=e}),!1}),E.set("Finger of Death","click"),C.set("Finger of Death",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]-=8-(r(e.cards[a][t].currentArmor)<0?r(e.cards[a][t].currentArmor):0),e.cards[a][t].updateDisplay(),e.collapse()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Efficient Killer","whenAttacking"),C.set("Efficient Killer",function(e,t){let a=y.lanes[t.detail.lane],n=t.detail.card+e.arrow;null!=a.cards[n]&&null!=a.cards[n][1-t.detail.player].Name&&"Hero"==a.cards[n][1-t.detail.player].CardType&&(e.currentAttack[4]+=4)}),E.set("Warmonger","whenAttacking"),C.set("Warmonger",function(e,t){let a=y.lanes[t.detail.lane],n=t.detail.card+e.arrow;null!=a.cards[n]&&null!=a.cards[n][1-t.detail.player].Name||(e.currentAttack[4]+=4)}),E.set("Precision Aura","continuousEffect"),C.set("Precision Aura",function(e,t){y.lanes.forEach(function(a){a.cards.forEach(function(a){null!=a[t.detail.player].Name&&a[t.detail.player]!=e&&(a[t.detail.player].currentAttack[4]+=1,a[t.detail.player].updateDisplay())})})}),E.set("Purification","click"),C.set("Purification",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]+=3,e.cards[a][t].currentHealth[0]>e.cards[a][t].Health&&(e.cards[a][t].currentHealth[0]=e.cards[a][t].Health),e.cards[a][t].updateDisplay()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Fissure","click"),C.set("Fissure",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n]==e});for(var l=-1;l<2;l+=1)null!=a.cards[r+l]&&null!=a.cards[r+l][1-n].Name&&(a.cards[r+l][1-n].disarmed=!0,a.cards[r+l][1-n].silenced=!0,a.cards[r+l][1-n].updateDisplay());return!0}),E.set("Headshot","click"),C.set("Headshot",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]-=5-r(e.cards[a][t].currentArmor),e.cards[a][t].updateDisplay(),e.collapse()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Barroom Brawler","afterUnitDies"),C.set("Barroom Brawler",function(e,t){let a=y.lanes[$.getCurrentLane()];t.detail.player,t.detail.card;return!(t.detail.player==t.detail.triggerPlayer||"Hero"!=a.cards[t.detail.triggerCard][t.detail.triggerPlayer].CardType||r(e.currentHealth)<0||t.detail.card+e.arrow!=t.detail.triggerCard)&&(e.currentArmor[1]+=2,e.updateDisplay(),!0)}),E.set("Barracks : Effect","endOfRound"),C.set("Barracks : Effect",function(e,t){null!=t.detail.lane&&$.extraDeploy[t.detail.player][t.detail.lane].push(w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[t.detail.player]))}),E.set("Grand Melee : Effect","continuousEffect"),C.set("Grand Melee : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.cards.some(function(e){return"Hero"==e[t.detail.player].CardType&&"Red"==e[t.detail.player].Color})&&a.cards.forEach(function(e){null!=e[t.detail.player].Name&&"Hero"==e[t.detail.player].CardType&&(e[t.detail.player].cleave[4]+=2,e[t.detail.player].updateDisplay()),null!=e[1-t.detail.player].Name&&"Hero"==e[1-t.detail.player].CardType&&(e[1-t.detail.player].cleave[4]+=2,e[1-t.detail.player].updateDisplay())})}),E.set("Assured Destruction : Effect","continuousEffect"),C.set("Assured Destruction : Effect",function(e,t){y.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&"Hero"==e[t.detail.player].CardType&&(e[t.detail.player].siege[4]+=4,e[t.detail.player].updateDisplay()),null!=e[1-t.detail.player].Name&&"Hero"==e[1-t.detail.player].CardType&&(e[1-t.detail.player].siege[4]+=4,e[1-t.detail.player].updateDisplay())})}),E.set("Howling Mind : Effect","endOfRound"),C.set("Howling Mind : Effect",function(e,t){$.players[0].draw(),$.players[1].draw()}),E.set("Ignite : Effect","beforeTheActionPhase"),C.set("Ignite : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.cards.forEach(function(e){null!=e[1-t.detail.player].Name&&(e[1-t.detail.player].currentHealth[0]-=1-(r(e[1-t.detail.player].currentArmor)<0?r(e[1-t.detail.player].currentArmor):0))}),a.collapse()}),E.set("Conflagration : Effect","beforeTheActionPhase"),C.set("Conflagration : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.cards.forEach(function(e){null!=e[1-t.detail.player].Name&&(e[1-t.detail.player].currentHealth[0]-=2-r(e[1-t.detail.player].currentArmor))}),a.collapse()}),E.set("Burning Oil : Effect","continuousEffect"),C.set("Burning Oil : Effect",function(e,t){}),E.set("Assault Ladders : Effect","whenAttacking"),C.set("Assault Ladders : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.cards.forEach(function(e,n){null!=e[t.detail.player].Name&&(null!=a.cards[n+e[t.detail.player].arrow]&&null!=a.cards[n+e[t.detail.player].arrow][1-t.detail.player].Name||(a.cards[n][t.detail.player].currentAttack[4]+=2))})}),E.set("Mist of Avernus : Effect","beforeTheActionPhase"),C.set("Mist of Avernus : Effect",function(e,t){y.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&(e[t.detail.player].currentAttack[1]+=1,e[t.detail.player].updateDisplay())})}),E.set("Altar of the Mad Moon : Effect","continuousEffect"),C.set("Altar of the Mad Moon : Effect",function(e,t){y.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&"Creep"==e[t.detail.player].CardType&&(e[t.detail.player].regen[4]+=2,e[t.detail.player].updateDisplay())})}),E.set("Verdant Refuge : Effect","continuousEffect"),C.set("Verdant Refuge : Effect",function(e,t){y.lanes[t.detail.lane].cards.forEach(function(e){null!=e[t.detail.player].Name&&(e[t.detail.player].currentArmor[4]+=1,e[t.detail.player].updateDisplay())})}),E.set("Escape Route : Effect","click"),C.set("Escape Route : Effect",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){let n=e.cards[a][t],r=D(e);n.div.parentNode.replaceChild(r.div,n.div),e.cards[a][t]=r,n.respawn=0,n.currentHealth[0]=n.Health,n.updateDisplay()},function(e,t,a){return y.lanes[$.getCurrentLane()]==e&&$.getTurn()==t&&"Hero"==e.cards[a][t].CardType}),!1}),E.set("Trebuchets : Effect","beforeTheActionPhase"),C.set("Trebuchets : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.towers[1-t.detail.player].currentHealth[0]-=2,a.towers[1-t.detail.player].updateDisplay()}),E.set("Unsupervised Artillery : Effect","click"),C.set("Unsupervised Artillery : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=a.cards.reduce(i,[[],[]])[1-$.getTurn()];for(var r=0;r<n.length;r++)if(null==a.cards[n[r]][$.getTurn()].Name)return!1;return a.towers[1-$.getTurn()].currentHealth[0]-=4,a.towers[1-$.getTurn()].updateDisplay(),!0}),E.set("Steam Cannon : Effect","click"),C.set("Steam Cannon : Effect",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]-=4-(r(e.cards[a][t].currentArmor)<0?r(e.cards[a][t].currentArmor):0),e.collapse()},function(){return!0}),!1}),E.set("Keenfolk Turret : Effect","click"),C.set("Keenfolk Turret : Effect",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]-=2-(r(e.cards[a][t].currentArmor)<0?r(e.cards[a][t].currentArmor):0),e.collapse()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Iron Fog Goldmine : Effect","afterCombat"),C.set("Iron Fog Goldmine : Effect",function(e,t){e.player.gold+=3,$.infoDisplayUpdate()}),E.set("Homefield Advantage : Effect","beforeTheActionPhase"),C.set("Homefield Advantage : Effect",function(e,t){let a=y.lanes[t.detail.lane],n=a.cards.reduce(i,[[],[]])[1-t.detail.player];0!=n.length&&(n=n[Math.floor(Math.random()*n.length)],null!=(n=a.cards[n])[1-t.detail.player].Name&&(n[1-t.detail.player].disarmed=!0,n[1-t.detail.player].updateDisplay()))}),E.set("Assassin's Apprentice : Effect","click"),C.set("Assassin's Apprentice : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n]==e});return A(e,t.currentTarget,"card",function(t,a,n){e.arrow=n-r},function(e,t,l){return e==a&&n!=t&&Math.abs(l-r)<=1}),!1}),E.set("Sister of the Veil : Effect","click"),C.set("Sister of the Veil : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n]==e});return A(e,t.currentTarget,"card",function(t,a,n){e.arrow=n-r},function(e,t,l){return e==a&&n!=t&&Math.abs(l-r)<=1}),!1}),E.set("Rebel Decoy : Effect","click"),C.set("Rebel Decoy : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n]==e});return A(e,t.currentTarget,"card",function(t,l,s){let i=r>s?e.div.nextSibling:t.cards[s][l].div.nextSibling;r>s?t.cards[s][l].div.parentNode.insertBefore(e.div,t.cards[s][l].div):e.div.parentNode.insertBefore(t.cards[s][l].div,e.div),r>s?e.div.parentNode.insertBefore(t.cards[s][l].div,i):t.cards[s][l].div.parentNode.insertBefore(e.div,i);let o=t.cards[s][l];t.cards[s][l]=a.cards[r][n],a.cards[r][n]=o,null!=a.cards[r][1-n].Name&&(a.cards[r][n].arrow=0,a.cards[r][n].updateDisplay()),null!=t.cards[s][1-l].Name&&(t.cards[s][l].arrow=0,t.cards[s][l].updateDisplay())},function(e,t,r){return e==a&&n==t}),!1}),E.set("Troll Soothsayer : Effect","endOfRound"),C.set("Troll Soothsayer : Effect",function(e,t){e.player.draw()}),E.set("Legion Standard Bearer : Effect","continuousEffect"),C.set("Legion Standard Bearer : Effect",function(e,t){for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentAttack[4]+=4,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Mercenary Exiles : Effect","click"),C.set("Mercenary Exiles : Effect",function(e,t){let a=Math.floor(e.player.gold/2);return e.player.gold=0,e.currentAttack[1]+=a,e.currentHealth[1]+=a,e.updateDisplay(),$.infoDisplayUpdate(),!0}),E.set("Satyr Magician : Effect","click"),C.set("Satyr Magician : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()].towers[$.getTurn()];return a.mana[0]=a.mana[1],a.updateDisplay(),!0}),E.set("Disciple of Nevermore : Effect","continuousEffect"),C.set("Disciple of Nevermore : Effect",function(e,t){let a=y.lanes[t.detail.lane];a.cards.forEach(function(e){null!=e[t.detail.player].Name&&a.cards[t.detail.card]!=e&&(e[t.detail.player].currentArmor[4]-=2,e[t.detail.player].currentAttack[4]+=2,e[t.detail.player].updateDisplay())})}),E.set("Ravenous Mass : Effect","click"),C.set("Ravenous Mass : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),l=a.cards.findIndex(function(t){return t[n]==e});for(var s=-1;s<2;s+=2)null!=a.cards[l+s]&&null!=a.cards[l+s][n].Name&&(e.currentAttack[1]+=r(a.cards[l+s][n].currentAttack),e.currentHealth[1]+=r(a.cards[l+s][n].currentHealth),$.condemn(a.cards[l+s][n],a));return a.collapse(),!0}),E.set("Rampaging Hellbear : Effect","afterCombat"),C.set("Rampaging Hellbear : Effect",function(e,t){e.currentAttack[1]+=4,e.updateDisplay()}),E.set("Savage Wolf : Effect","afterCombat"),C.set("Savage Wolf : Effect",function(e,t){e.currentAttack[1]+=1,e.currentHealth[1]+=2,e.updateDisplay()}),E.set("Satyr Duelist : Effect","afterCombat"),C.set("Satyr Duelist : Effect",function(e,t){e.currentAttack[1]+=2,e.updateDisplay()}),E.set("Savage Wolf : Effect","afterCombat"),C.set("Savage Wolf : Effect",function(e,t){e.currentAttack[1]+=1,e.currentHealth[1]+=2,e.updateDisplay()}),E.set("Selfish Cleric : Effect","afterCombat"),C.set("Selfish Cleric : Effect",function(e,t){e.currentHealth[0]=e.Health,e.updateDisplay()}),E.set("Revtel Convoy : Effect","continuousEffect"),C.set("Revtel Convoy : Effect",function(e,t){let a=Math.floor(e.player.gold/2);e.currentAttack[4]+=a,e.updateDisplay()}),E.set("Thunderhide Pack : Effect","continuousEffect"),C.set("Thunderhide Pack : Effect",function(e,t){e.siege[4]+=6,e.updateDisplay()}),E.set("Ogre Corpse Tosser : Effect","afterUnitDies"),C.set("Ogre Corpse Tosser : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=t.detail.player;return console.log(a.cards[t.detail.triggerCard][t.detail.triggerPlayer].Name),!(t.detail.player!=t.detail.triggerPlayer||"Melee Creep"!=a.cards[t.detail.triggerCard][t.detail.triggerPlayer].Name||r(e.currentHealth)<0)&&(console.log("Tossed"),a.towers[1-n].currentHealth[0]-=2-(r(a.towers[1-n].currentArmor)<0?r(a.towers[1-n].currentArmor):0),a.towers[1-n].updateDisplay(),!0)}),E.set("Emissary of the Quorum : Effect","click"),C.set("Emissary of the Quorum : Effect",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn();return a.cards.forEach(function(e){null!=e[n].Name&&(e[n].currentAttack[1]+=2,e[n].currentHealth[1]+=2,e[n].updateDisplay())}),!0}),E.set("Plague Ward : Effect","beforeTheActionPhase"),C.set("Plague Ward : Effect",function(e,t){let a=y.lanes[t.detail.lane],n=t.detail.card-1<0?0:t.detail.card-1,l=a.cards.slice(n,t.detail.card+2).reduce(i,[[],[]])[1-t.detail.player];0!=l.length&&(l=l[Math.floor(Math.random()*l.length)]+n,null!=(l=a.cards[l])[1-t.detail.player].Name&&(l[1-t.detail.player].currentHealth[0]-=2-(r(l[1-t.detail.player].currentArmor)<0?r(l[1-t.detail.player].currentArmor):0),l[1-t.detail.player].updateDisplay()))}),E.set("Prowler Vanguard : Effect","continuousEffect"),C.set("Prowler Vanguard : Effect",function(e,t){for(var a=-1;a<2;a+=2){let e=y.lanes[t.detail.lane],n=t.detail.card;null!=e.cards[n+a]&&null!=e.cards[n+a][t.detail.player].Name&&(e.cards[n+a][t.detail.player].currentArmor[4]+=1,e.cards[n+a][t.detail.player].updateDisplay())}}),E.set("Pit Fighter of Quoidge : Effect","afterUnitDies"),C.set("Pit Fighter of Quoidge : Effect",function(e,t){y.lanes[$.getCurrentLane()],t.detail.player,t.detail.card;return console.log("boop"),!(t.detail.player!=t.detail.triggerPlayer||r(e.currentHealth)<0||t.detail.card+1!=t.detail.triggerCard&&t.detail.card-1!=t.detail.triggerCard)&&(e.currentAttack[1]+=2,e.updateDisplay(),!0)}),E.set("Assassin's Shadow : Effect","continuousEffect"),C.set("Assassin's Shadow : Effect",function(e,t){let a=y.lanes[t.detail.lane];return e.siege[4]+=5,e.currentAttack[4]-=2*(a.cards.reduce(i,[[],[]])[t.detail.player].length-1),e.updateDisplay(),!0}),E.set("Leather Armor : Effect","continuousEffect"),C.set("Leather Armor : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=1,a.updateDisplay()}),E.set("Traveler's Cloak : Effect","continuousEffect"),C.set("Traveler's Cloak : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=4,a.updateDisplay()}),E.set("Short Sword : Effect","continuousEffect"),C.set("Short Sword : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.updateDisplay()}),E.set("Demagicking Maul : Effect","continuousEffect"),C.set("Demagicking Maul : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.updateDisplay()}),E.set("Demagicking Maul : EffectActive","click"),C.set("Demagicking Maul : EffectActive",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n].Weapon==e});if(null==a.cards[r+a.cards[r][n].arrow][1-n].Name&&a.improvements[1-n].length){let e=Math.floor(Math.random()*a.improvements[1-n].length);return(e=a.improvements[1-n].splice(e)[0]).div.parentNode.removeChild(e.div),!0}return!1}),E.set("Stonehall Plate : Effect","continuousEffect"),C.set("Stonehall Plate : Effect",function(e,t){e.stonehall||(e.div.addEventListener("afterCombat",function(){e.Armor=e.Armor||1,e.Armor+=1}),e.stonehall=!0);let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];e.Armor=e.Armor||1,a.currentArmor[4]+=e.Armor,a.updateDisplay()}),E.set("Stonehall Cloak : Effect","continuousEffect"),C.set("Stonehall Cloak : Effect",function(e,t){e.stonehall||(e.div.addEventListener("afterCombat",function(){e.Health=e.Health||4,e.Health+=2}),e.stonehall=!0);let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];e.Health=e.Health||4,a.currentHealth[4]+=e.Health,a.updateDisplay()}),E.set("Blade of the Vigil : Effect","continuousEffect"),C.set("Blade of the Vigil : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.cleave[4]+=2,a.updateDisplay()}),E.set("Keenfolk Musket : Effect","continuousEffect"),C.set("Keenfolk Musket : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.updateDisplay()}),E.set("Keenfolk Musket : EffectActive","click"),C.set("Keenfolk Musket : EffectActive",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]-=2-r(e.cards[a][t].currentArmor),e.collapse()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Red Mist Maul : Effect","continuousEffect"),C.set("Red Mist Maul : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.siege[4]+=5,a.updateDisplay()}),E.set("Shield of Basilius : Effect","continuousEffect"),C.set("Shield of Basilius : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=2,a.updateDisplay();for(var n=-1;n<2;n+=2){let e=y.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentArmor[4]+=1,e.cards[a+n][t.detail.player].updateDisplay())}}),E.set("Horn of the Alpha : Effect","continuousEffect"),C.set("Horn of the Alpha : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=4,a.updateDisplay()}),E.set("Horn of the Alpha : EffectActive","click"),C.set("Horn of the Alpha : EffectActive",function(e,t){let a=[[],[]],n=y.lanes[$.getCurrentLane()],r=w(F.Cards.find(function(e){return"Thunderhide Pack"==e.Name}),$.players[$.getTurn()]);return a[$.getTurn()].push(r),n.summon(a),!0}),E.set("Ring of Tarrasque : Effect","continuousEffect"),C.set("Ring of Tarrasque : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=4,a.regen[4]+=6,a.updateDisplay()}),E.set("Phase Boots : Effect","continuousEffect"),C.set("Phase Boots : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=4,a.updateDisplay()}),E.set("Phase Boots : EffectActive","click"),C.set("Phase Boots : EffectActive",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n].Accessory==e}),l=a.cards[r][n];return A(e,t.currentTarget,"card",function(e,t,s){let i=r>s?l.div.nextSibling:e.cards[s][t].div.nextSibling;r>s?e.cards[s][t].div.parentNode.insertBefore(l.div,e.cards[s][t].div):l.div.parentNode.insertBefore(e.cards[s][t].div,l.div),r>s?l.div.parentNode.insertBefore(e.cards[s][t].div,i):e.cards[s][t].div.parentNode.insertBefore(l.div,i);let o=e.cards[s][t];e.cards[s][t]=a.cards[r][n],a.cards[r][n]=o,null!=a.cards[r][1-n].Name&&(a.cards[r][n].arrow=0,a.cards[r][n].updateDisplay()),null!=e.cards[s][1-t].Name&&(e.cards[s][t].arrow=0,e.cards[s][t].updateDisplay())},function(e,t,r){return e==a&&n==t}),!1}),E.set("Broadsword : Effect","continuousEffect"),C.set("Broadsword : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=4,a.updateDisplay()}),E.set("Claymore : Effect","continuousEffect"),C.set("Claymore : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=8,a.updateDisplay()}),E.set("Chainmail : Effect","continuousEffect"),C.set("Chainmail : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=2,a.updateDisplay()}),E.set("Platemail : Effect","continuousEffect"),C.set("Platemail : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=4,a.updateDisplay()}),E.set("Barbed Mail : Effect","continuousEffect"),C.set("Barbed Mail : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=2,a.retaliate[4]+=2,a.updateDisplay()}),E.set("Hero's Cape : Effect","continuousEffect"),C.set("Hero's Cape : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=16,a.updateDisplay()}),E.set("Fur-lined Mantle : Effect","continuousEffect"),C.set("Fur-lined Mantle : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentHealth[4]+=8,a.updateDisplay()}),E.set("Stonehall Pike : Effect","continuousEffect"),C.set("Stonehall Pike : Effect",function(e,t){e.stonehall||(e.div.addEventListener("afterCombat",function(){e.Attack=e.Attack||2,e.Attack+=1}),e.stonehall=!0);let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];e.Attack=e.Attack||2,a.currentAttack[4]+=e.Attack,a.updateDisplay()}),E.set("Blink Dagger : Effect","continuousEffect"),C.set("Blink Dagger : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=2,a.updateDisplay()}),E.set("Blink Dagger : EffectActive","click"),C.set("Blink Dagger : EffectActive",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),r=a.cards.findIndex(function(t){return t[n].Weapon==e}),l=a.cards[r][n],s=[[],[]],i=D(a);return A(e,t.currentTarget,"lane",function(e){a.cards[r][n]=i,l.div.parentNode.replaceChild(i.div,l.div),s[n].push(l),e.summon(s)},function(e){return e!=a}),!1}),E.set("Wingfall Hammer : Effect","continuousEffect"),C.set("Wingfall Hammer : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentAttack[4]+=4,a.updateDisplay()}),E.set("Wingfall Hammer : EffectActive","click"),C.set("Wingfall Hammer : EffectActive",function(e,t){let a=y.lanes[$.getCurrentLane()],n=$.getTurn(),l=a.cards.findIndex(function(t){return t[n].Weapon==e});for(var s=-1;s<=1;s++)console.log(l),null!=a.cards[l+s]&&null!=a.cards[l+s][n].Name&&(a.cards[l+s][n].regen[3]+=Math.floor(r(a.cards[l][n].currentAttack)/2),a.cards[l+s][n].updateDisplay());return!0}),E.set("Rumusque Vestments : Effect","continuousEffect"),C.set("Rumusque Vestments : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=1,a.updateDisplay()}),E.set("Rumusque Vestments : EffectActive","click"),C.set("Rumusque Vestments : EffectActive",function(e,t){return A(e,t.currentTarget,"card",function(e,t,a){e.cards[a][t].currentHealth[0]+=4,e.cards[a][t].currentHealth[0]>e.cards[a][t].Health&&(e.cards[a][t].currentHealth[0]=e.cards[a][t].Health),e.cards[a][t].updateDisplay()},function(e,t,a){return e==y.lanes[$.getCurrentLane()]}),!1}),E.set("Shield of Aquila : Effect","continuousEffect"),C.set("Shield of Aquila : Effect",function(e,t){let a=y.lanes[t.detail.lane].cards[t.detail.card][t.detail.player];a.currentArmor[4]+=2,a.updateDisplay();for(var n=-1;n<2;n+=2){let e=y.lanes[t.detail.lane],a=t.detail.card;null!=e.cards[a+n]&&null!=e.cards[a+n][t.detail.player].Name&&(e.cards[a+n][t.detail.player].currentArmor[4]+=3,e.cards[a+n][t.detail.player].updateDisplay())}});const L=e=>{if("Hero"==e[$.getTurn()].CardType&&!e[$.getTurn()].silenced)return e[$.getTurn()].Color==v.Color},D=(e,t,a)=>{let n=document.createElement("div");n.classList.add("blank"),null!=t&&(a?t.insertBefore(n,t.childNodes[a-1].nextSibling):t.insertBefore(n,t.firstChild)),n.ondragover=function(e){e.preventDefault()},n.ondragenter=function(e){e.target.classList.add("dragover")},n.ondragleave=function(e){e.target.classList.remove("dragover")},n.ondrop=(e=>r(e));const r=t=>{if(t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),!(y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]<v.ManaCost)&&e==$.getCurrentLane()&&"Creep"==v.CardType&&y.lanes[$.getCurrentLane()].cards.some(L)){let t=y.lanes[e].cards.flat().findIndex(function(e){return e.div==l.div}),a=t%2;t=Math.floor(t/2),a==$.getTurn()&&(v.div.draggable=!1,n.parentNode.replaceChild(v.div,n),y.lanes[e].cards[t][a]=v,y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]-=v.ManaCost,y.lanes[$.getCurrentLane()].towers[$.getTurn()].updateDisplay(),null!=y.lanes[e].cards[t][1-a].Name&&(y.lanes[e].cards[t][1-a].arrow=0,y.lanes[e].cards[t][1-a].updateDisplay()),$.players[$.getTurn()].hand.splice($.players[$.getTurn()].hand.indexOf(v),1),y.lanes[e].collapse(),y.lanes[e].expand(),$.dispatchEvent("continuousRefresh"),$.nextTurn())}};let l={div:n,drop:r};return{div:n,drop:r}},w=(e,t)=>{let a="../node_modules/artifactdb/assets",n=document.createElement("div"),l=()=>{},s=()=>{},i=()=>{},o=()=>{},d={div:n,player:t};n.classList.add("card",e.Color,e.CardType);let c=document.createElement("IMG");if(c.draggable=!1,c.src=`${a}/artwork/large/${e.FileName}.jpg`,c.onerror=function(){c.src="../src/placeholder.png"},n.appendChild(c),"Hero"==e.CardType&&(d.respawn=0,d.Bounty=5),"Creep"==e.CardType&&(d.Bounty=1),null!=e.ManaCost){let t=document.createElement("div");t.classList.add("mana-cost"),t.textContent=e.ManaCost,n.appendChild(t)}if("Consumable"==e.ItemType&&(d.ManaCost=0),null!=e.GoldCost){let t=document.createElement("div");t.classList.add("gold-cost"),t.textContent=e.GoldCost,n.appendChild(t)}if(null!=e.Text&&""!=e.Text){let t=document.createElement("div");t.classList.add("card-text");let r=document.createElement("IMG");r.draggable=!1,r.src=`${a}/text_background.jpg`;let l=document.createElement("span");l.textContent=e.Text,n.appendChild(t),t.appendChild(r),t.appendChild(l)}let u=document.createElement("div");if(u.classList.add("name"),u.textContent=e.Name,n.appendChild(u),"Hero"==e.CardType){var f=document.createElement("div");f.classList.add("items"),n.appendChild(f),d.Weapon=null;var h=document.createElement("div");h.classList.add("Weapon"),f.appendChild(h),d.Armor=null;var g=document.createElement("div");g.classList.add("Armor"),f.appendChild(g),d.Accessory=null;var A=document.createElement("div");A.classList.add("Accessory"),f.appendChild(A)}if("Creep"==e.CardType||"Hero"==e.CardType){d.arrow=0;let t=["left","middle","right"],c=document.createElement("div");c.classList.add("arrow",t[1+d.arrow]),n.appendChild(c),d.rndArrow=((t,a,n)=>{if("number"==typeof t&&(t=y.lanes[t]),null==t.cards[a][1-n].Name){let r=Math.random();r=r>.75?1:(r>.25)-1,null!=t.cards[a+r]&&null!=t.cards[a+r][1-n].Name||(r=0),e.arrow=r}e.updateDisplay()}),l=T(l,function(){c.classList.remove("left","middle","right"),c.classList.add("arrow",t[1+e.arrow])}),d.cleave=[0,0,0,0,0,0],d.retaliate=[0,0,0,0,0,0],d.siege=[0,0,0,0,0,0],d.regen=[0,0,0,0,0,0],d.silenced=!1,d.disarmed=!1,l=T(l,function(){n.title=`Cleave : ${r(e.cleave)}\nRetaliate : ${r(e.retaliate)}\nSiege : ${r(e.siege)}\nRegeneration : ${r(e.regen)}`,r(e.cleave)>0?c.classList.add("cleave"):c.classList.remove("cleave"),r(e.retaliate)>0?n.classList.add("retaliate"):n.classList.remove("retaliate"),r(e.siege)>0?c.classList.add("siege"):c.classList.remove("siege"),e.silenced?n.classList.add("silenced"):n.classList.remove("silenced"),e.disarmed?n.classList.add("disarmed"):n.classList.remove("disarmed")}),s=T(s,function(){e.cleave[3]=0,e.retaliate[3]=0,e.siege[3]=0,e.regen[3]=0,e.silenced=!1,e.disarmed=!1}),o=T(o,function(){e.cleave[4]=0,e.retaliate[4]=0,e.siege[4]=0,e.regen[4]=0}),i=T(i,function(){e.cleave[5]=0,e.retaliate[5]=0,e.siege[5]=0,e.regen[5]=0}),d.currentHealth=[e.Health,0,0,0,0,0];let u=document.createElement("div");u.classList.add("icon-container","health");let f=document.createElement("IMG");f.draggable=!1,f.src=`${a}/icon/cardstat-health.png`;let p=document.createElement("div");p.textContent=r(d.currentHealth),u.appendChild(f),u.appendChild(p),n.appendChild(u),l=T(l,function(){p.textContent=r(e.currentHealth)}),s=T(s,function(){e.currentHealth[3]=0}),o=T(o,function(){e.currentHealth[4]=0}),i=T(i,function(){e.currentHealth[5]=0}),d.currentAttack=[e.Attack,0,0,0,0,0];let m=document.createElement("div");m.classList.add("icon-container","attack");let h=document.createElement("IMG");h.draggable=!1,h.src=`${a}/icon/cardstat-attack.png`;let g=document.createElement("div");g.textContent=e.Attack,m.appendChild(h),m.appendChild(g),n.appendChild(m),l=T(l,function(){g.textContent=r(e.currentAttack)}),s=T(s,function(){e.currentAttack[3]=0}),o=T(o,function(){e.currentAttack[4]=0}),i=T(i,function(){e.currentAttack[5]=0}),d.currentArmor=[e.Armor,0,0,0,0,0];let v=document.createElement("div");v.classList.add("icon-container","armor");let C=document.createElement("IMG");C.draggable=!1,C.src=`${a}/icon/cardstat-armor.png`;let E=document.createElement("div");E.textContent=e.Armor,v.appendChild(C),v.appendChild(E),n.appendChild(v),l=T(l,function(){E.textContent=r(e.currentArmor)}),s=T(s,function(){e.currentArmor[3]=0}),o=T(o,function(){e.currentArmor[4]=0}),i=T(i,function(){e.currentArmor[5]=0})}if(null!=e.Abilities){d.Abilities=[];let r=document.createElement("div");r.classList.add("abilities-container"),e.Abilities.forEach(function(i,o){(i=Object.assign({},i)).div=document.createElement("div"),i.div.classList.add("ability-container");let c=document.createElement("IMG");if(c.draggable=!1,"Hero"==e.CardType){let e=function(e){return e.replace(" : Effect","").replace(/\s/g,"_").replace("'","-").toLowerCase()}(i.Name);c.src=`${a}/ability/${e}.jpg`}else o>0&&(i.Name=i.Name+i.Type),c.src=`${a}/artwork/small/${e.FileName}.jpg`;c.onerror=function(){c.src="../src/placeholder.png"},c.title=i.Text,i.div.appendChild(c),r.appendChild(i.div),"Active"==i.Type?(i.div.classList.add("Active"),"Hero"==e.CardType?i.currentCooldown=i.Cooldown:i.currentCooldown=0,i.cooldownDiv=document.createElement("div"),i.cooldownDiv.classList.add("cooldown","display-none"),i.cooldownDiv.textContent=i.currentCooldown,i.div.appendChild(i.cooldownDiv),i.div.addEventListener("click",function(a){!e.silenced&&$.players[$.getTurn()]==t&&$.getCurrentLane()==("Improvement"==e.CardType?y.lanes.findIndex(function(t){return t.improvements.flat().some(function(t){return t.div==e.div})}):"Item"!=e.CardType?y.lanes.findIndex(function(t){return t.cards.flat().some(function(t){return t.div==e.div})}):"Weapon"==e.ItemType?y.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Weapon)return t.Weapon.div==e.div})}):"Armor"==e.ItemType?y.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Armor)return t.Armor.div==e.div})}):"Accessory"==e.ItemType?y.lanes.findIndex(function(t){return t.cards.flat().some(function(t){if(t.Accessory)return t.Accessory.div==e.div})}):void 0)&&e.Abilities[o].currentCooldown<=0&&C.get(i.Name)(e,a)&&(e.Abilities[o].currentCooldown=e.Abilities[o].Cooldown,l(),$.nextTurn())}),s=T(s,function(){e.Abilities[o].currentCooldown-=1}),l=T(l,function(){e.Abilities[o].currentCooldown<=0?e.Abilities[o].cooldownDiv.classList.add("display-none"):(e.Abilities[o].cooldownDiv.classList.remove("display-none"),e.Abilities[o].cooldownDiv.textContent=e.Abilities[o].currentCooldown)})):n.addEventListener(E.get(i.Name),function(t){C.get(i.Name)(e,t)}),d.Abilities.push(i)}),n.appendChild(r)}return n.ondragover=function(e){e.preventDefault()},n.addEventListener("dragenter",function(e){e.target.classList.add("dragover")}),n.addEventListener("dragleave",function(e){e.target.classList.remove("dragover")}),n.ondrop=(e=>d.drop(e)),d.drop=(t=>{if(t.preventDefault(),null!=t&&t.target.classList.remove("dragover"),y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]>=v.ManaCost){let e=y.lanes.findIndex(function(e){return e.div==t.currentTarget.parentNode.parentNode});if((e==$.getCurrentLane()||v.CrossLane)&&"unit"==m.get(v.Name)&&(y.lanes[$.getCurrentLane()].cards.some(L)||"Item"==v.CardType)){let a=y.lanes[e].cards.flat().findIndex(function(e){return e.div==t.currentTarget}),n=a%2;a=Math.floor(a/2),p.get(v.Name)(t,e,n,a)&&(v.div.draggable=!1,y.lanes[$.getCurrentLane()].towers[$.getTurn()].mana[0]-=v.ManaCost,y.lanes[$.getCurrentLane()].towers[$.getTurn()].updateDisplay(),v.div.parentNode.removeChild(v.div),$.players[$.getTurn()].hand.splice($.players[$.getTurn()].hand.indexOf(v),1),$.dispatchEvent("continuousRefresh"),$.nextTurn())}}else if("Hero"==e.CardType&&"Item"==v.CardType){y.lanes.findIndex(function(e){return e.div==t.currentTarget.parentNode.parentNode})==$.getCurrentLane()&&("Armor"==v.ItemType&&(e.Armor&&g.removeChild(g.firstChild),e.Armor=v,g.appendChild(v.div)),"Accessory"==v.ItemType&&(e.Accessory&&A.removeChild(A.firstChild),e.Accessory=v,A.appendChild(v.div)),"Weapon"==v.ItemType&&(e.Weapon&&h.removeChild(h.firstChild),e.Weapon=v,h.appendChild(v.div)),$.players[$.getTurn()].hand.splice($.players[$.getTurn()].hand.indexOf(v),1),$.dispatchEvent("continuousRefresh"),$.nextTurn())}}),n.addEventListener("click",function(){console.log(e)}),n.ondragstart=function(t){v=e,null!=t.dataTransfer&&t.dataTransfer.setData("text/plain"," ")},n.addEventListener("endOfRound",s),n.addEventListener("afterCombat",i),n.addEventListener("continuousRefresh",o),d.updateDisplay=l,e=Object.assign({},e,d)};var k=(()=>{const e=document.getElementById("zoom-btn"),t=document.getElementById("zoom-btn-left"),a=document.getElementById("zoom-btn-middle"),n=document.getElementById("zoom-btn-right");e.addEventListener("click",function(){y.div.classList.toggle("zoom-out"),$.div.classList.toggle("zoom-out"),y.lanes[$.getCurrentLane()].div.scrollIntoView({inline:"center"})}),t.addEventListener("click",function(){y.div.classList.remove("zoom-out"),$.div.classList.remove("zoom-out"),y.lanes[0].div.scrollIntoView({inline:"center"})}),a.addEventListener("click",function(){y.div.classList.remove("zoom-out"),$.div.classList.remove("zoom-out"),y.lanes[1].div.scrollIntoView({inline:"center"})}),n.addEventListener("click",function(){y.div.classList.remove("zoom-out"),$.div.classList.remove("zoom-out"),y.lanes[2].div.scrollIntoView({inline:"center"})});return{updateActive:()=>{switch($.getCurrentLane()){case 0:t.classList.add("active"),a.classList.remove("active"),n.classList.remove("active");break;case 1:t.classList.remove("active"),a.classList.add("active"),n.classList.remove("active");break;case 2:t.classList.remove("active"),a.classList.remove("active"),n.classList.add("active")}}}})();var b=(()=>{const e=document.getElementById("pass-btn-bottom"),t=document.getElementById("pass-btn-top"),a=()=>{e.classList.add("display-none"),t.classList.add("display-none")};return a(),setTimeout(function(){e.onclick=$.pass,t.onclick=$.pass},100),{enable:()=>{$.getTurn()?t.disabled=!1:e.disabled=!1,$.getTurn()?e.disabled=!0:t.disabled=!0},disable:()=>{e.disabled=!0,t.disabled=!0},hide:a,show:()=>{e.classList.remove("display-none"),t.classList.remove("display-none")}}})();var N=(()=>{let e=[],t=[];return{initialize:()=>{e=[$.players[0].hand,$.players[1].hand],t=[$.players[0].handDiv,$.players[1].handDiv]},enable:()=>{e[$.getTurn()].forEach(function(e){e.div.draggable=!0}),e[1-$.getTurn()].forEach(function(e){e.div.draggable=!1})},disable:()=>{for(var t=0;t<e.length;t++)e[t].forEach(function(e){e.div.draggable=!1})},hide:()=>{for(var a=0;a<e.length;a++)t[a].classList.add("hide")},show:()=>{for(var a=0;a<e.length;a++)t[a].classList.remove("hide")}}})();const H=[],M=document.createElement("button");let S=[];function B(e){e.preventDefault()}function I(e){e.target.classList.add("dragover")}function P(e){e.target.classList.remove("dragover")}function x(){const e=document.createElement("div");e.classList.add("bottom","display-none");const t=document.createElement("div");t.classList.add("top","display-none"),H.push(e),H.push(t),H.forEach(function(e){e.classList.add("stage","UI"),$.div.appendChild(e)}),M.classList.add("deploy-btn","btn","UI","display-none"),M.textContent="Deploy",$.div.appendChild(M),M.addEventListener("click",function(){H[0].hasChildNodes()||H[1].hasChildNodes()?alert("Need to choose lanes for all Heros"):function(){(function(){for(let e=0;e<2;e++)H[e].classList.add("display-none"),y.lanes.forEach(function(t){t.stages[e].classList.add("display-none")})})(),M.classList.add("display-none");for(let e=0;e<3;e++){let t=y.lanes[e];t.summon([S[0][e],S[1][e]],!1),0!=$.getRound()&&t.cards.forEach(function(e,a){e.forEach(function(e,n){null!=e.Name&&e.rndArrow(t,a,n)})})}$.dispatchEvent("continuousRefresh"),$.players.forEach(function(e){e.draw(),e.draw()}),$.nextTurn(),$.dispatchEvent("beforeTheActionPhase"),b.show(),N.show()}()}),y.lanes.forEach(function(e,t){e.stages.forEach(function(e,a){e.ondragover=B,e.ondragenter=I,e.ondragleave=P,e.ondrop=function(n){n.preventDefault(),P(n),v.player==$.players[a]&&"Hero"==v.CardType&&(e.appendChild(v.div),S[a][t].push(v),v.div.draggable=!1)}})})}function R(){S[0]=[[],[],[]],S[1]=[[],[],[]],null==H[0]&&x(),y.div.classList.add("zoom-out"),$.div.classList.add("zoom-out"),function(){for(let e=0;e<2;e++)H[e].classList.remove("display-none"),y.lanes.forEach(function(t){t.stages[e].classList.remove("display-none")})}(),S.forEach(function(e,t){for(let a=0;a<2;a++){let a=Math.floor(3*Math.random()),n=w(F.Cards.find(function(e){return"Melee Creep"==e.Name}),$.players[t]);e[a].push(n),y.lanes[a].stages[t].appendChild(n.div)}if(0==$.getRound()){let r=n([0,1,2]);for(var a=0;a<3;a++){let n=$.players[t].getHeros()[a];y.lanes[r[a]].stages[t].appendChild(n.div),e[r[a]].push(n)}}$.extraDeploy[t].forEach(function(a,n){a.forEach(function(a){e[n].push(a),y.lanes[n].stages[t].appendChild(a.div)}),a.splice(0)}),$.players[t].getHeros().forEach(function(a){if(0==a.respawn&&0!=$.getRound())if($.players[t].computer){let n=Math.floor(3*Math.random());e[n].push(a),y.lanes[n].stages[t].appendChild(a.div)}else H[t].appendChild(a.div),a.div.draggable=!0,a.updateDisplay();a.respawn-=1})}),M.classList.remove("display-none")}var W=(()=>{const e=document.getElementById("shop"),t=document.getElementById("secret-shop"),a=document.getElementById("item-deck"),r=document.getElementById("consumables"),l=document.createElement("button");let s;l.innerHTML="Done",l.classList.add("close-btn","btn"),l.type="submit",e.appendChild(l);let i=["Healing Salve","Town Portal Scroll","Fountain Flask","Potion of Knowledge"];l.addEventListener("click",function(){e.classList.add("display-none"),t.firstChild&&t.removeChild(t.firstChild),J.push(s.Name),s=null,a.firstChild&&a.removeChild(a.firstChild),r.firstChild&&r.removeChild(r.firstChild),R()});const o=(e,t=!1)=>{let r;if(t&&(e=n(e)),null!=(r=t?e.shift():e[Math.floor(Math.random()*e.length)])){let e=w(F.Cards.find(function(e){return e.Name==r}),$.players[0]);return e.div.addEventListener("click",function n(r){$.players[0].gold>=e.GoldCost&&($.players[0].gold-=e.GoldCost,$.infoDisplayUpdate(),$.players[0].hand.push(e),$.players[0].handDiv.appendChild(e.div),t&&(s=o(J,!0))&&a.appendChild(s.div),e.div.removeEventListener("click",n))}),e}return!1};return{show:()=>{s=o(J,!0);let n=o(i),d=o(Y);t.appendChild(d.div),s&&a.appendChild(s.div),r.appendChild(n.div),e.classList.remove("display-none"),l.focus()}}})();var G=()=>{const e=[],t=[document.getElementById("info-bottom"),document.getElementById("info-top")];$.players.forEach(function(a,n){t[n].classList.remove("display-none"),t[n].getElementsByClassName("name")[0].textContent=`${a.name}`,e.push(t[n].getElementsByClassName("gold")[0]),e[n].textContent=a.gold});return{updateDisplay:()=>{$.players.forEach(function(t,a){e[a].textContent=t.gold})}}};a.d(t,"game",function(){return $}),a.d(t,"cardData",function(){return F}),a.d(t,"posAvail",function(){return U}),a.d(t,"battle",function(){return z}),a.d(t,"itemDeck",function(){return J}),a.d(t,"secretShopDeck",function(){return Y});let F="not loaded yet";!function(e){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET","../node_modules/artifactdb/cards-manifest.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}(function(e){F=JSON.parse(e).Sets[0]});const O=(e,t)=>{e=[e];let a=document.createElement("div"),n=document.createElement("span");n.textContent=r(e);let l=document.createElement("div");a.appendChild(l),a.appendChild(n),l.classList.add("mana");let s=!1,i=[3,3];l.textContent=`${i[0]} : ${i[1]}`;setTimeout(function(){y.lanes[t].div.addEventListener("endOfRound",function(){o.mana[1]+=1,o.manaDiv.textContent=`${o.mana[0]} : ${o.mana[1]}`,i[0]=i[1],o.manaDiv.textContent=`${i[0]} : ${i[1]}`})},10);let o={currentHealth:e,div:a,Name:"tower",currentArmor:[0],mana:i,manaDiv:l,updateDisplay:()=>{r(o.currentHealth)<=0&&($.score[1-t]+=1,s||(s=!s,o.currentHealth=[80],a.classList.add("ancient"))),n.textContent=r(o.currentHealth),o.manaDiv.textContent=`${o.mana[0]} : ${o.mana[1]}`}};return o},V=(e,t,a,r,l=!1)=>{let s={};return(a=a.map(function(e){return w(F.Cards.find(function(t){return t.Name==e}),s)}))[3].respawn=1,a[4].respawn=2,n(r),s.turn=e,s.handDiv=e?document.getElementById("hand-top"):document.getElementById("hand-bottom"),s.hand=[],s.draw=(()=>{let e=r.shift();if(null!=e){let t=w(F.Cards.find(function(t){return t.Name==e}),s);s.hand.push(t),s.handDiv.appendChild(t.div)}}),s.getHeros=(()=>a),s.name=t,s.computer=l,s.gold=0,s},$=(()=>{const e=document.getElementById("game");let t,a=[0,1],n=Math.random()<.5,l=0,s=0,i=[0,0];let o=new CustomEvent("afterCombat",{detail:{lane:void 0,card:void 0,player:void 0}}),d=new CustomEvent("endOfRound",{detail:{lane:void 0,card:void 0,player:void 0}}),c=new CustomEvent("continuousRefresh",{detail:{lane:void 0,card:void 0,player:void 0}}),u=new CustomEvent("continuousEffect",{detail:{lane:void 0,card:void 0,player:void 0}}),p=new CustomEvent("whenAttacking",{detail:{lane:void 0,card:void 0,player:void 0}}),m=new CustomEvent("beforeTheActionPhase",{detail:{lane:void 0,card:void 0,player:void 0}}),h=new CustomEvent("afterUnitDies",{detail:{lane:void 0,card:void 0,player:void 0,triggerLane:void 0,triggerCard:void 0,triggerPlayer:void 0}});function g(e,t,a,n){let r={afterCombat:e=>{if(e==s)return o},endOfRound:e=>d,beforeTheActionPhase:e=>{if(e==s)return m},continuousRefresh:e=>c,_continuousEffect:e=>u,whenAttacking:e=>{if(e==s)return p},afterUnitDies:e=>{if(e==s)return h}};y.lanes.forEach(function(l,s){let i=r[e](s);null!=i&&(a&&Object.assign(i.detail,{triggerLane:t,triggerCard:a,triggerPlayer:n}),i.detail.lane=s,l.cards.forEach(function(e,t){i.detail.card=t,e.forEach(function(e,t){null!=e.Name&&(i.detail.player=t,e.div.dispatchEvent(i),"Hero"==e.CardType&&(e.Accessory&&(e.Accessory.div.dispatchEvent(i),e.Accessory.updateDisplay()),e.Armor&&(e.Armor.div.dispatchEvent(i),e.Armor.updateDisplay()),e.Weapon&&(e.Weapon.div.dispatchEvent(i),e.Weapon.updateDisplay())),e.updateDisplay())})}),null!=i&&l.div.dispatchEvent(i),l.improvements.forEach(function(e,t){i.detail.player=t,e.forEach(function(e,t){i.detail.card=t,e.div.dispatchEvent(i),e.updateDisplay()})}))}),"continuousRefresh"==e&&g("_continuousEffect"),"endOfRound"==e&&$.players.forEach(function(t,a){t.getHeros().forEach(function(t){let n=r[e]();n.detail.player=a,n.detail.lane=null,t.respawn>=0&&t.div.dispatchEvent(n)})})}function v(e=!1){n=1-n,e||(y.lanes[s].passCount=0),b.enable(),N.enable(),y.lanes[s].collapse(!1),y.lanes[s].expand(),a[n].computer&&setTimeout(function(){f.actionPhase(a[n])},300)}return{div:e,getCurrentLane:()=>s,startGame:()=>{console.log("Game Started"),a[0]=V(0,"Radiant",Q,j),a[1]=V(1,"Dire",_,q,!0),function(){let e=["left-lane","middle-lane","right-lane"],t=["bottom","top"];y.lanes.forEach(function(a,n){a.name=e[n],a.div.classList.add("lane",e[n]),y.div.appendChild(a.div);for(var r=1;r>=0;r--)a.playAreas[r]=document.createElement("div"),a.playAreas[r].classList.add("playarea",`playarea-${t[r]}`),a.towers[r]=O(40,r),a.towers[r].div.classList.add("tower",`tower-${t[r]}`),a.div.appendChild(a.playAreas[r]),a.div.appendChild(a.towers[r].div),a.stages[r]=document.createElement("div"),a.stages[r].classList.add("stage",`stage-${t[r]}`,"display-none"),a.div.appendChild(a.stages[r]);a.playAreas[1].addEventListener("scroll",function(){a.playAreas[0].scrollLeft=a.playAreas[1].scrollLeft}),a.playAreas[0].addEventListener("scroll",function(){a.playAreas[1].scrollLeft=a.playAreas[0].scrollLeft})})}(),t=G(),y.lanes[s].div.classList.add("active"),R(),$.players.forEach(function(e){for(var t=0;t<3;t++)e.draw()}),N.initialize(),b.enable(),k.updateActive()},getRound:()=>l,score:i,gameOver:()=>!(i[0]<2&&i[1]<2||(i[0]>=2&&i[1]>=2?alert("Tie Game"):i[0]>=2?alert(`${a[0].name} Wins`):i[1]>=2&&alert(`DEFErunT : ${a[1].name} Wins`),b.hide(),0)),getTurn:()=>n,nextTurn:v,pass:()=>{y.lanes[s].passCount+=1,y.lanes[s].passCount>1?(function(){let e=y.lanes[$.getCurrentLane()];$.dispatchEvent("whenAttacking"),e.cards.forEach(function(t,a){t.forEach(function(t,n){if(null!=t.Name&&!t.disarmed){let s=e.cards[a+t.arrow][1-n];if(null==s||null==s.Name)s=e.towers[1-n];else if(r(s.retaliate)>0&&(t.currentHealth[0]-=r(s.retaliate)-r(t.currentArmor)),r(t.siege)>0&&(e.towers[1-n].currentHealth[0]-=r(t.siege)),r(t.cleave)>0)for(var l=-1;l<2;l+=2){let s=e.cards[a+t.arrow+l];null!=s&&null!=(s=e.cards[a+t.arrow+l][1-n])&&null!=s.Name&&(s.currentHealth[0]-=r(t.cleave)-r(s.currentArmor))}s.currentHealth[0]-=r(t.currentAttack)-r(s.currentArmor)}}),t.forEach(function(e,t){null!=e.Name&&(r(e.regen)>0&&(e.currentHealth[0]+=r(e.regen)),e.currentHealth[0]>e.Health&&(e.currentHealth[0]=e.Health))})}),y.collapse(),e.towers[1].updateDisplay(),e.towers[0].updateDisplay(),$.dispatchEvent("afterCombat"),$.infoDisplayUpdate(),$.gameOver()}(),y.lanes[s].div.classList.remove("active"),(s+=1)>2?(b.hide(),N.hide(),W.show(),a[0].computer&&f.shop(0),a[1].computer&&f.shop(1),g("endOfRound"),s=0,l+=1):(v(),g("beforeTheActionPhase")),y.lanes[s].div.classList.add("active"),k.updateActive()):v(!0)},condemn:(e,t)=>{let a=t.cards.flat().indexOf(e),n=D(y.lanes.indexOf(t));g("afterUnitDies",y.lanes.indexOf(t),Math.floor(a/2),a%2),e.div.classList.add("condemned"),e.div.parentNode.replaceChild(n.div,e.div),t.cards[Math.floor(a/2)][a%2]=n,e.player==$.players[0]?$.players[1].gold+=e.Bounty:$.players[0].gold+=e.Bounty,null!=e.respawn&&(e.respawn=1,e.currentHealth[0]=e.Health,e.updateDisplay())},players:a,extraDeploy:[[[],[],[]],[[],[],[]]],infoDisplayUpdate:()=>{t.updateDisplay()},dispatchEvent:g}})();function U(e,t,a){return null==t[0].Name&&e[0].push(a),null==t[1].Name&&e[1].push(a),e}function z(e,t,a,n,l,s,i=!0,o=!0){let d=y.lanes[e].cards[a][t],c=y.lanes[n].cards[s][l];if(i){let r=new CustomEvent("whenAttacking",{detail:{lane:e,card:a,player:t}});d.div.dispatchEvent(r),d.updateDisplay(),"Hero"==d.CardType&&(d.Accessory&&(d.Accessory.div.dispatchEvent(r),d.Accessory.updateDisplay()),d.Armor&&(d.Armor.div.dispatchEvent(r),d.Armor.updateDisplay()),d.Weapon&&(d.Weapon.div.dispatchEvent(r),d.Weapon.updateDisplay())),r.detail.lane=n,r.detail.card=s,r.detail.player=l,c.div.dispatchEvent(r),c.updateDisplay(),"Hero"==c.CardType&&(c.Accessory&&(c.Accessory.div.dispatchEvent(r),c.Accessory.updateDisplay()),c.Armor&&(c.Armor.div.dispatchEvent(r),c.Armor.updateDisplay()),c.Weapon&&(c.Weapon.div.dispatchEvent(r),c.Weapon.updateDisplay()))}d.disarmed||(r(c.retaliate)>0&&(d.currentHealth[0]-=r(c.retaliate)-r(d.currentArmor)),c.currentHealth[0]-=r(d.currentAttack)-r(c.currentArmor)),$.infoDisplayUpdate(),o&&z(n,l,s,e,t,a,!1,!1)}const K=["Assassin's Shadow","Pit Fighter of Quoidge","Viscous Nasal Goo","Ogre Corpse Tosser","Murder Plot","Collateral Damage","Combat Training","Pick a Fight","Trebuchets","Unsupervised Artillery","Homefield Advantage","Iron Fog Goldmine","Assured Destruction","Escape Route","Howling Mind","Grand Melee","Assassinate","Echo Slam","Winter's Curse","Battlefield Control","Gust","Act of Defiance","Frostbite","Gank","Duel","Berserker's Call","Prowler Vanguard","Coup de Grace","Mystic Flare","Sow Venom","Barracks","Eclipse","Savage Wolf","Fighting Instinct","Thunderhide Pack","Emissary of the Quorum","New Orders","Ion Shell","Time of Triumph","Forward Charge","Altar of the Mad Moon","New Orders","Sister of the Veil","Rebel Decoy","Steam Cannon","Keenfolk Turret","Assassin's Apprentice","Grazing Shot","No Accident","Slay","Pick Off","Selfish Cleric","Revtel Convoy","Ravenous Mass","Rampaging Hellbear","Satyr Duelist","Savage Wolf","Satyr Magician","Disciple of Nevermore","Legion Standard Bearer","Mercenary Exiles","Verdant Refuge","Mist of Avernus","Ignite","Assault Ladders","Mana Drain","Payday","Arcane Censure","Stars Align","Bellow","Rumusque Blessing","Defensive Bloom","Restoration Effort","Intimidation","Curse of Atrophy","Strafing Run","Lightning Strike","Rolling Storm","Tower Barrage","Foresight","Prey on the Weak","Remote Detonation","Thunderstorm","Bolt of Damocles","Poised to Strike","Defensive Stance","Enrage","God's Strength","Spring the Trap","Double Edge","Conflagration","Call the Reserves","Better Late Than Never","Iron Branch Protection","Avernus' Blessing","Dimensional Portal","Bronze Legionnaire","Marrowfell Brawler","Ogre Conscript","Troll Soothsayer","Untested Grunt","Thunderhide Alpha"];let j,q=["Assassin's Shadow","Pit Fighter of Quoidge","Viscous Nasal Goo","Ogre Corpse Tosser","Collateral Damage","Combat Training","Trebuchets","Homefield Advantage","Iron Fog Goldmine","Payday","Assured Destruction","Howling Mind","Assassinate","Echo Slam","Winter's Curse","Gust","Act of Defiance","Frostbite","Berserker's Call","Prowler Vanguard","Coup de Grace","Mystic Flare","Sow Venom","Barracks","Thunderhide Pack","Altar of the Mad Moon","Time of Triumph","Forward Charge","Ion Shell","Sister of the Veil","Rebel Decoy","Assassin's Apprentice","Grazing Shot","No Accident","Slay","Pick Off","Selfish Cleric","Revtel Convoy","Ravenous Mass","Rampaging Hellbear","Satyr Duelist","Savage Wolf","Satyr Magician","Disciple of Nevermore","Legion Standard Bearer","Mercenary Exiles","Verdant Refuge","Mist of Avernus","Ignite","Assault Ladders","Mana Drain","Arcane Censure","Stars Align","Bellow","Rumusque Blessing","Defensive Bloom","Restoration Effort","Intimidation","Curse of Atrophy","Strafing Run","Lightning Strike","Rolling Storm","Tower Barrage","Foresight","Prey on the Weak","Remote Detonation","Thunderstorm","Bolt of Damocles","Poised to Strike","Defensive Stance","Enrage","God's Strength","Spring the Trap","Double Edge","Conflagration","Call the Reserves","Better Late Than Never","Iron Branch Protection","Avernus' Blessing","Dimensional Portal","Bronze Legionnaire","Marrowfell Brawler","Ogre Conscript","Troll Soothsayer","Untested Grunt","Thunderhide Alpha"],_=["Bristleback","J'Muy the Wise","Legion Commander","Lycan","Centaur Warrunner","Drow Ranger","Sorla Khan","Phantom Assassin","Bounty Hunter","Venomancer","Prellex","Sven","Luna","Treant Protector","Enchantress","Debbi the Cunning","Keefe the Bold","Fahrvhan the Dreamer","Axe"];_=n(_).slice(0,5);let Q,J,X=["Legion Commander","Lycan","Winter Wyvern","Skywrath Mage","Centaur Warrunner","Bristleback","Earthshaker","Omniknight","Drow Ranger","Sorla Khan","Phantom Assassin","Lion","Lich","Bounty Hunter","Venomancer","Prellex","Pugna","Sven","Luna","Treant Protector","Enchantress","Debbi the Cunning","Keefe the Bold","Sniper","Fahrvhan the Dreamer","J'Muy the Wise","Axe"],Y=["Rumusque Vestments","Wingfall Hammer","Blink Dagger","Broadsword","Claymore","Chainmail","Fur-lined Mantle","Hero's Cape","Platemail","Barbed Mail","Demagicking Maul","Stonehall Plate","Stonehall Cloak","Leather Armor","Short Sword","Traveler's Cloak","Blade of the Vigil","Keenfolk Musket","Red Mist Maul","Shield of Basilius","Horn of the Alpha","Phase Boots","Ring of Tarrasque"];const Z=document.getElementById("start-game-btn"),ee=document.getElementById("deck-textarea"),te=document.getElementById("item-textarea"),ae=document.getElementById("heroes-textarea"),ne=document.getElementById("deck-game-btn"),re=document.getElementById("item-game-btn"),le=document.getElementById("heroes-game-btn"),se=document.getElementById("start-screen"),ie=document.getElementById("deck-options"),oe=document.getElementById("item-options"),de=document.getElementById("heroes-options"),ce=document.getElementById("deck-reset-btn"),ue=document.getElementById("deck-3of"),fe=document.getElementById("item-reset-btn"),pe=document.getElementById("heroes-reset-btn"),me=document.getElementById("refresh-btn");ne.title="If card is not vaild or implemented it will be ignored",le.title="Uses the 1st 5 heroes",ee.value=localStorage.getItem("deck"),ee.value=ee.value||K,ee.placeholder="  If empty all cards will be added to your deck.",ue.checked=null==localStorage.getItem("3of")||"true"==localStorage.getItem("3of"),ae.value=localStorage.getItem("heroes"),ae.value=ae.value||X,ee.title="adds 3 of each listed card",ae.placeholder="  If empty your heroes will be Legion Commander, Lycan, Winter Wyvern, Skywrath Mage, Centaur Warrunner",te.value=localStorage.getItem("item"),te.value=te.value||Y,te.placeholder="  If empty all items will be added to your item deck.",Z.disabled=!0;setTimeout(function(){Z.disabled=!1},500),Z.addEventListener("click",function(){q=q.filter(function(e){let t=F.Cards.find(function(t){return t.Name==e}).Color;return _.map(function(e){return F.Cards.find(function(t){return t.Name==e}).Color}).includes(t)}),(Q=(Q=(Q=ae.value.split(",")).map(function(e){return e.trim()})).filter(function(e){return X.includes(e)})).length<5&&(Q=X),localStorage.setItem("heroes",Q),Q.length>5&&(Q=Q.slice(0,5)),(j=(j=(j=(j=ee.value.split(",")).map(function(e){return e.trim()})).filter(function(e){return K.includes(e)})).filter(function(e){let t=F.Cards.find(function(t){return t.Name==e}).Color;return Q.map(function(e){return F.Cards.find(function(t){return t.Name==e}).Color}).includes(t)})).length||(j=(j=K).filter(function(e){let t=F.Cards.find(function(t){return t.Name==e}).Color;return Q.map(function(e){return F.Cards.find(function(t){return t.Name==e}).Color}).includes(t)})),localStorage.setItem("deck",j),localStorage.setItem("3of",ue.checked),ue.checked&&(j=j.concat(j,j)),(J=(J=(J=te.value.split(",")).map(function(e){return e.trim()})).filter(function(e){return Y.includes(e)})).length<9&&(J=Y),localStorage.setItem("item",J),q=q.concat(q,q),se.parentNode.removeChild(se),me.disabled=!1,$.startGame()}),ne.addEventListener("click",function(){ee.classList.toggle("display-none"),te.classList.add("display-none"),ae.classList.add("display-none"),ie.classList.toggle("display-none"),oe.classList.add("display-none"),de.classList.add("display-none")}),re.addEventListener("click",function(){te.classList.toggle("display-none"),ee.classList.add("display-none"),ae.classList.add("display-none"),oe.classList.toggle("display-none"),de.classList.add("display-none"),ie.classList.add("display-none")}),le.addEventListener("click",function(){ae.classList.toggle("display-none"),ee.classList.add("display-none"),te.classList.add("display-none"),de.classList.toggle("display-none"),ie.classList.add("display-none"),oe.classList.add("display-none")}),ce.addEventListener("click",function(){ee.value=K}),fe.addEventListener("click",function(){te.value=Y}),pe.addEventListener("click",function(){ae.value=X}),me.title="Makes sure everything is updated and you have at least one space to play a creep",me.addEventListener("click",function(){y.collapse(),y.lanes[$.getCurrentLane()].expand(),$.dispatchEvent("continuousRefresh")})}]);